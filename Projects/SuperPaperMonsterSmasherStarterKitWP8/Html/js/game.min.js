!function(a){"use strict";if(Number.prototype.map=function(a,b,c,d){return c+(d-c)*((this-a)/(b-a))},Number.prototype.limit=function(a,b){return Math.min(b,Math.max(a,this))},Number.prototype.round=function(a){return a=Math.pow(10,a||0),Math.round(this*a)/a},Number.prototype.floor=function(){return Math.floor(this)},Number.prototype.ceil=function(){return Math.ceil(this)},Number.prototype.toInt=function(){return 0|this},Number.prototype.toRad=function(){return this/180*Math.PI},Number.prototype.toDeg=function(){return 180*this/Math.PI},Array.prototype.erase=function(a){for(var b=this.length;b--;)this[b]===a&&this.splice(b,1);return this},Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]},Function.prototype.bind=Function.prototype.bind||function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e},a.ig={game:null,debug:null,version:"1.21",global:a,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:a.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(a){return"#"==a.charAt(0)?document.getElementById(a.substr(1)):document.getElementsByTagName(a)},$new:function(a){return document.createElement(a)},copy:function(a){if(!a||"object"!=typeof a||a instanceof HTMLElement||a instanceof ig.Class)return a;if(a instanceof Array){for(var b=[],c=0,d=a.length;d>c;c++)b[c]=ig.copy(a[c]);return b}var b={};for(var c in a)b[c]=ig.copy(a[c]);return b},merge:function(a,b){for(var c in b){var d=b[c];"object"!=typeof d||d instanceof HTMLElement||d instanceof ig.Class?a[c]=d:(a[c]&&"object"==typeof a[c]||(a[c]=d instanceof Array?[]:{}),ig.merge(a[c],d))}return a},ksort:function(a){if(!a||"object"!=typeof a)return[];var b=[],c=[];for(var d in a)b.push(d);b.sort();for(var d=0;d<b.length;d++)c.push(a[b[d]]);return c},setVendorAttribute:function(a,b,c){var d=b.charAt(0).toUpperCase()+b.substr(1);a[b]=a["ms"+d]=a["moz"+d]=a["webkit"+d]=a["o"+d]=c},getVendorAttribute:function(a,b){var c=b.charAt(0).toUpperCase()+b.substr(1);return a[b]||a["ms"+c]||a["moz"+c]||a["webkit"+c]||a["o"+c]},normalizeVendorAttribute:function(a,b){var c=ig.getVendorAttribute(a,b);!a[b]&&c&&(a[b]=c)},getImagePixels:function(a,b,c,d,e){var f=ig.$new("canvas");f.width=a.width,f.height=a.height;var g=f.getContext("2d");ig.System.SCALE.CRISP(f,g);var h=ig.getVendorAttribute(g,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(g,"getImageDataHD");var i=a.width/h,j=a.height/h;return f.width=Math.ceil(i),f.height=Math.ceil(j),g.drawImage(a,0,0,i,j),1===h?g.getImageData(b,c,d,e):g.getImageDataHD(b,c,d,e)},module:function(a){if(ig._current)throw"Module '"+ig._current.name+"' defines nothing";if(ig.modules[a]&&ig.modules[a].body)throw"Module '"+a+"' is already defined";return ig._current={name:a,requires:[],loaded:!1,body:null},ig.modules[a]=ig._current,ig._loadQueue.push(ig._current),ig},requires:function(){return ig._current.requires=Array.prototype.slice.call(arguments),ig},defines:function(a){ig._current.body=a,ig._current=null,ig._initDOMReady()},addResource:function(a){ig.resources.push(a)},setNocache:function(a){ig.nocache=a?"?"+Date.now():""},log:function(){},assert:function(){},show:function(){},mark:function(){},_loadScript:function(a,b){ig.modules[a]={name:a,requires:[],loaded:!1,body:null},ig._waitForOnload++;var c=ig.prefix+ig.lib+a.replace(/\./g,"/")+".js"+ig.nocache,d=ig.$new("script");d.type="text/javascript",d.src=c,d.onload=function(){ig._waitForOnload--,ig._execModules()},d.onerror=function(){throw"Failed to load module "+a+" at "+c+" "+"required from "+b},ig.$("head")[0].appendChild(d)},_execModules:function(){for(var a=!1,b=0;b<ig._loadQueue.length;b++){for(var c=ig._loadQueue[b],d=!0,e=0;e<c.requires.length;e++){var f=c.requires[e];ig.modules[f]?ig.modules[f].loaded||(d=!1):(d=!1,ig._loadScript(f,c.name))}d&&c.body&&(ig._loadQueue.splice(b,1),c.loaded=!0,c.body(),a=!0,b--)}if(a)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){for(var g=[],b=0;b<ig._loadQueue.length;b++){for(var h=[],i=ig._loadQueue[b].requires,e=0;e<i.length;e++){var c=ig.modules[i[e]];c&&c.loaded||h.push(i[e])}g.push(ig._loadQueue[b].name+" (requires: "+h.join(", ")+")")}throw"Unresolved (circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules:\n"+g.join("\n")}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0,ig._waitForOnload--,ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&ig.setNocache(!0),ig.ua.pixelRatio=a.devicePixelRatio||1,ig.ua.viewport={width:a.innerWidth,height:a.innerHeight},ig.ua.screen={width:a.screen.availWidth*ig.ua.pixelRatio,height:a.screen.availHeight*ig.ua.pixelRatio},ig.ua.iPhone=/iPhone/i.test(navigator.userAgent),ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio,ig.ua.iPad=/iPad/i.test(navigator.userAgent),ig.ua.android=/android/i.test(navigator.userAgent),ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent),ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad,ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone,ig.ua.touchDevice="ontouchstart"in a||a.navigator.msMaxTouchPoints},_initDOMReady:function(){return ig.modules["dom.ready"]?(ig._execModules(),void 0):(ig._boot(),ig.modules["dom.ready"]={requires:[],loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),a.addEventListener("load",ig._DOMReady,!1)),void 0)}},ig.normalizeVendorAttribute(a,"requestAnimationFrame"),a.requestAnimationFrame){var b=1,c={};a.ig.setAnimation=function(d,e){var f=b++;c[f]=!0;var g=function(){c[f]&&(a.requestAnimationFrame(g,e),d())};return a.requestAnimationFrame(g,e),f},a.ig.clearAnimation=function(a){delete c[a]}}else a.ig.setAnimation=function(b){return a.setInterval(b,1e3/60)},a.ig.clearAnimation=function(b){a.clearInterval(b)};var d=!1,e=/xyz/.test(function(){})?/\bparent\b/:/.*/;a.ig.Class=function(){};var f=function(a){var b=this.prototype,c={};for(var d in a)"function"==typeof a[d]&&"function"==typeof b[d]&&e.test(a[d])?(c[d]=b[d],b[d]=function(a,b){return function(){var d=this.parent;this.parent=c[a];var e=b.apply(this,arguments);return this.parent=d,e}}(d,a[d])):b[d]=a[d]};a.ig.Class.extend=function(b){function c(){if(!d){if(this.staticInstantiate){var a=this.staticInstantiate.apply(this,arguments);if(a)return a}for(var b in this)"object"==typeof this[b]&&(this[b]=ig.copy(this[b]));this.init&&this.init.apply(this,arguments)}return this}var g=this.prototype;d=!0;var h=new this;d=!1;for(var i in b)h[i]="function"==typeof b[i]&&"function"==typeof g[i]&&e.test(b[i])?function(a,b){return function(){var c=this.parent;this.parent=g[a];var d=b.apply(this,arguments);return this.parent=c,d}}(i,b[i]):b[i];return c.prototype=h,c.prototype.constructor=c,c.extend=a.ig.Class.extend,c.inject=f,c},a.ImpactMixin&&ig.merge(ig,a.ImpactMixin)}(window),ig.baked=!0,ig.module("impact.image").defines(function(){"use strict";ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(a){return ig.Image.cache[a]||null},init:function(a){this.path=a,this.load()},load:function(a){return this.loaded?(a&&a(this.path,!0),void 0):(!this.loaded&&ig.ready?(this.loadCallback=a||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),ig.Image.cache[this.path]=this,void 0)},reload:function(){this.loaded=!1,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.src=this.path+"?"+Date.now()},onload:function(){this.width=this.data.width,this.height=this.data.height,this.loaded=!0,1!=ig.system.scale&&this.resize(ig.system.scale),this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(){this.failed=!0,this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(a){var b=ig.getImagePixels(this.data,0,0,this.width,this.height),c=this.width*a,d=this.height*a,e=ig.$new("canvas");e.width=c,e.height=d;for(var f=e.getContext("2d"),g=f.getImageData(0,0,c,d),h=0;d>h;h++)for(var i=0;c>i;i++){var j=4*(Math.floor(h/a)*this.width+Math.floor(i/a)),k=4*(h*c+i);g.data[k]=b.data[j],g.data[k+1]=b.data[j+1],g.data[k+2]=b.data[j+2],g.data[k+3]=b.data[j+3]}f.putImageData(g,0,0),this.data=e},draw:function(a,b,c,d,e,f){if(this.loaded){var g=ig.system.scale;c=c?c*g:0,d=d?d*g:0,e=(e?e:this.width)*g,f=(f?f:this.height)*g,ig.system.context.drawImage(this.data,c,d,e,f,ig.system.getDrawPos(a),ig.system.getDrawPos(b),e,f),ig.Image.drawCount++}},drawTile:function(a,b,c,d,e,f,g){if(e=e?e:d,!(!this.loaded||d>this.width||e>this.height)){var h=ig.system.scale,i=Math.floor(d*h),j=Math.floor(e*h),k=f?-1:1,l=g?-1:1;(f||g)&&(ig.system.context.save(),ig.system.context.scale(k,l)),ig.system.context.drawImage(this.data,Math.floor(c*d)%this.width*h,Math.floor(c*d/this.width)*e*h,i,j,ig.system.getDrawPos(a)*k-(f?i:0),ig.system.getDrawPos(b)*l-(g?j:0),i,j),(f||g)&&ig.system.context.restore(),ig.Image.drawCount++}}}),ig.Image.drawCount=0,ig.Image.cache={},ig.Image.reloadCache=function(){for(var a in ig.Image.cache)ig.Image.cache[a].reload()}}),ig.baked=!0,ig.module("impact.font").requires("impact.image").defines(function(){"use strict";ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(a){this._loadMetrics(this.data),this.parent(a)},widthForString:function(a){if(-1!==a.indexOf("\n")){for(var b=a.split("\n"),c=0,d=0;d<b.length;d++)c=Math.max(c,this._widthForLine(b[d]));return c}return this._widthForLine(a)},_widthForLine:function(a){for(var b=0,c=0;c<a.length;c++)b+=this.widthMap[a.charCodeAt(c)-this.firstChar]+this.letterSpacing;return b},heightForString:function(a){return a.split("\n").length*(this.height+this.lineSpacing)},draw:function(a,b,c,d){if("string"!=typeof a&&(a=a.toString()),-1===a.indexOf("\n")){if(d==ig.Font.ALIGN.RIGHT||d==ig.Font.ALIGN.CENTER){var e=this._widthForLine(a);b-=d==ig.Font.ALIGN.CENTER?e/2:e}1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);for(var f=0;f<a.length;f++){var g=a.charCodeAt(f);b+=this._drawChar(g-this.firstChar,b,c)}1!==this.alpha&&(ig.system.context.globalAlpha=1),ig.Image.drawCount+=a.length}else for(var h=a.split("\n"),i=this.height+this.lineSpacing,f=0;f<h.length;f++)this.draw(h[f],b,c+f*i,d)},_drawChar:function(a,b,c){if(!this.loaded||0>a||a>=this.indices.length)return 0;var d=ig.system.scale,e=this.indices[a]*d,f=0,g=this.widthMap[a]*d,h=(this.height-2)*d;return ig.system.context.drawImage(this.data,e,f,g,h,ig.system.getDrawPos(b),ig.system.getDrawPos(c),g,h),this.widthMap[a]+this.letterSpacing},_loadMetrics:function(a){this.height=a.height-1,this.widthMap=[],this.indices=[];for(var b=ig.getImagePixels(a,0,a.height-1,a.width,1),c=0,d=0,e=0;e<a.width;e++){var f=4*e+3;b.data[f]>127?d++:b.data[f]<128&&d&&(this.widthMap.push(d),this.indices.push(e-d),c++,d=0)}this.widthMap.push(d),this.indices.push(e-d)}}),ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}}),ig.baked=!0,ig.module("impact.sound").defines(function(){"use strict";ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)return ig.Sound.enabled=!1,void 0;for(var a=new Audio,b=0;b<ig.Sound.use.length;b++){var c=ig.Sound.use[b];if(a.canPlayType(c.mime)){this.format=c;break}}this.format||(ig.Sound.enabled=!1)},load:function(a,b,c){var d=ig.prefix+a.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[a]){if(b&&this.clips[a].length<ig.Sound.channels)for(var e=this.clips[a].length;e<ig.Sound.channels;e++){var f=new Audio(d);f.load(),this.clips[a].push(f)}return this.clips[a][0]}var g=new Audio(d);if(c&&(g.addEventListener("canplaythrough",function h(b){g.removeEventListener("canplaythrough",h,!1),c(a,!0,b)},!1),g.addEventListener("error",function(b){c(a,!1,b)},!1)),g.preload="auto",g.load(),this.clips[a]=[g],b)for(var e=1;e<ig.Sound.channels;e++){var f=new Audio(d);f.load(),this.clips[a].push(f)}return g},get:function(a){for(var b,c=this.clips[a],d=0;b=c[d++];)if(b.paused||b.ended)return b.ended&&(b.currentTime=0),b;return c[0].pause(),c[0].currentTime=0,c[0]}}),ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this),Object.defineProperty?(Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)}),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})):this.__defineGetter__&&(this.__defineGetter__("volume",this.getVolume.bind(this)),this.__defineSetter__("volume",this.setVolume.bind(this)),this.__defineGetter__("loop",this.getLooping.bind(this)),this.__defineSetter__("loop",this.setLooping.bind(this)))},add:function(a,b){if(ig.Sound.enabled){var c=a instanceof ig.Sound?a.path:a,d=ig.soundManager.load(c,!1);d.loop=this._loop,d.volume=this._volume,d.addEventListener("ended",this._endedCallbackBound,!1),this.tracks.push(d),b&&(this.namedTracks[b]=d),this.currentTrack||(this.currentTrack=d)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(a){if(a&&this.namedTracks[a]){var b=this.namedTracks[a];b!=this.currentTrack&&(this.stop(),this.currentTrack=b)}else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(a){this._loop=a;for(var b in this.tracks)this.tracks[b].loop=a},getVolume:function(){return this._volume},setVolume:function(a){this._volume=a.limit(0,1);for(var b in this.tracks)this.tracks[b].volume=this._volume},fadeOut:function(a){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new ig.Timer(a),this._fadeInterval=setInterval(this._fadeStep.bind(this),50))},_fadeStep:function(){var a=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;.01>=a?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=a},_endedCallback:function(){this._loop?this.play():this.next()}}),ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,init:function(a,b){this.path=a,this.multiChannel=b!==!1,this.load()},load:function(a){return ig.Sound.enabled?(ig.ready?ig.soundManager.load(this.path,this.multiChannel,a):ig.addResource(this),void 0):(a&&a(this.path,!0),void 0)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}}),ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},CAF:{ext:"caf",mime:"audio/x-caf"}},ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3],ig.Sound.channels=4,ig.Sound.enabled=!0}),ig.baked=!0,ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){"use strict";ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(a,b){this.gameClass=a,this.resources=b,this._loadCallbackBound=this._loadCallback.bind(this);for(var c=0;c<this.resources.length;c++)this._unloaded.push(this.resources[c].path)},load:function(){if(ig.system.clear("#000"),!this.resources.length)return this.end(),void 0;for(var a=0;a<this.resources.length;a++)this.loadResource(this.resources[a]);this._intervalId=setInterval(this.draw.bind(this),16)},loadResource:function(a){a.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId),ig.system.setGame(this.gameClass))},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var a=ig.system.scale,b=.6*ig.system.width,c=.1*ig.system.height,d=.5*ig.system.width-b/2,e=.5*ig.system.height-c/2;ig.system.context.fillStyle="#000",ig.system.context.fillRect(0,0,480,320),ig.system.context.fillStyle="#fff",ig.system.context.fillRect(d*a,e*a,b*a,c*a),ig.system.context.fillStyle="#000",ig.system.context.fillRect(d*a+a,e*a+a,b*a-a-a,c*a-a-a),ig.system.context.fillStyle="#fff",ig.system.context.fillRect(d*a,e*a,b*a*this._drawStatus,c*a)},_loadCallback:function(a,b){if(!b)throw"Failed to load resource: "+a;this._unloaded.erase(a),this.status=1-this._unloaded.length/this.resources.length,0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})}),ig.baked=!0,ig.module("impact.timer").defines(function(){"use strict";ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(a){this.base=ig.Timer.time,this.last=ig.Timer.time,this.target=a||0},set:function(a){this.target=a||0,this.base=ig.Timer.time,this.pausedAt=0},reset:function(){this.base=ig.Timer.time,this.pausedAt=0},tick:function(){var a=ig.Timer.time-this.last;return this.last=ig.Timer.time,this.pausedAt?0:a},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}}),ig.Timer._last=0,ig.Timer.time=Number.MIN_VALUE,ig.Timer.timeScale=1,ig.Timer.maxStep=.05,ig.Timer.step=function(){var a=Date.now(),b=(a-ig.Timer._last)/1e3;ig.Timer.time+=Math.min(b,ig.Timer.maxStep)*ig.Timer.timeScale,ig.Timer._last=a}}),ig.baked=!0,ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){"use strict";ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(a,b,c,d,e){this.fps=b,this.clock=new ig.Timer,this.canvas=ig.$(a),this.resize(c,d,e),this.context=this.canvas.getContext("2d"),this.getDrawPos=ig.System.drawMode,1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP),ig.System.scaleMode(this.canvas,this.context)},resize:function(a,b,c){this.width=a,this.height=b,this.scale=c||this.scale,this.realWidth=this.width*this.scale,this.realHeight=this.height*this.scale,this.canvas.width=this.realWidth,this.canvas.height=this.realHeight},setGame:function(a){this.running?this.newGameClass=a:this.setGameNow(a)},setGameNow:function(a){ig.game=new a,ig.system.setDelegate(ig.game)},setDelegate:function(a){if("function"!=typeof a.run)throw"System.setDelegate: No run() function in object";this.delegate=a,this.startRunLoop()},stopRunLoop:function(){ig.clearAnimation(this.animationId),this.running=!1},startRunLoop:function(){this.stopRunLoop(),this.animationId=ig.setAnimation(this.run.bind(this),this.canvas),this.running=!0},clear:function(a){this.context.fillStyle=a,this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step(),this.tick=this.clock.tick(),this.delegate.run(),ig.input.clearPressed(),this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null}),ig.System.DRAW={AUTHENTIC:function(a){return Math.round(a)*this.scale},SMOOTH:function(a){return Math.round(a*this.scale)},SUBPIXEL:function(a){return a*this.scale}},ig.System.drawMode=ig.System.DRAW.SMOOTH,ig.System.SCALE={CRISP:function(a,b){ig.setVendorAttribute(b,"imageSmoothingEnabled",!1),a.style.imageRendering="-moz-crisp-edges",a.style.imageRendering="-o-crisp-edges",a.style.imageRendering="-webkit-optimize-contrast",a.style.imageRendering="crisp-edges",a.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(a,b){ig.setVendorAttribute(b,"imageSmoothingEnabled",!0),a.style.imageRendering="",a.style.msInterpolationMode=""}},ig.System.scaleMode=ig.System.SCALE.SMOOTH}),ig.baked=!0,ig.module("impact.input").defines(function(){"use strict";ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190},ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var a=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",a,!1),ig.system.canvas.addEventListener("DOMMouseScroll",a,!1),ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1),ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1),ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||window.addEventListener("devicemotion",this.devicemotion.bind(this),!1)},mousewheel:function(a){var b=a.wheelDelta?a.wheelDelta:-1*a.detail,c=b>0?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN,d=this.bindings[c];d&&(this.actions[d]=!0,this.presses[d]=!0,this.delayedKeyup[d]=!0,a.stopPropagation(),a.preventDefault())},mousemove:function(a){var b=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,c=ig.system.scale*(b/ig.system.realWidth),d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(d=ig.system.canvas.getBoundingClientRect());var e=a.touches?a.touches[0]:a;this.mouse.x=(e.clientX-d.left)/c,this.mouse.y=(e.clientY-d.top)/c},contextmenu:function(a){this.bindings[ig.KEY.MOUSE2]&&(a.stopPropagation(),a.preventDefault())},keydown:function(a){var b=a.target.tagName;if("INPUT"!=b&&"TEXTAREA"!=b){var c="keydown"==a.type?a.keyCode:2==a.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1;("touchstart"==a.type||"mousedown"==a.type)&&this.mousemove(a);var d=this.bindings[c];d&&(this.actions[d]=!0,this.locks[d]||(this.presses[d]=!0,this.locks[d]=!0),a.stopPropagation(),a.preventDefault())}},keyup:function(a){var b=a.target.tagName;if("INPUT"!=b&&"TEXTAREA"!=b){var c="keyup"==a.type?a.keyCode:2==a.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,d=this.bindings[c];d&&(this.delayedKeyup[d]=!0,a.stopPropagation(),a.preventDefault())}},devicemotion:function(a){this.accel=a.accelerationIncludingGravity},bind:function(a,b){0>a?this.initMouse():a>0&&this.initKeyboard(),this.bindings[a]=b},bindTouch:function(a,b){var c=ig.$(a),d=this;c.addEventListener("touchstart",function(a){d.touchStart(a,b)},!1),c.addEventListener("touchend",function(a){d.touchEnd(a,b)},!1),c.addEventListener("MSPointerDown",function(a){d.touchStart(a,b)},!1),c.addEventListener("MSPointerUp",function(a){d.touchEnd(a,b)},!1)},unbind:function(a){var b=this.bindings[a];this.delayedKeyup[b]=!0,this.bindings[a]=null},unbindAll:function(){this.bindings={},this.actions={},this.presses={},this.locks={},this.delayedKeyup={}},state:function(a){return this.actions[a]},pressed:function(a){return this.presses[a]},released:function(a){return this.delayedKeyup[a]},clearPressed:function(){for(var a in this.delayedKeyup)this.actions[a]=!1,this.locks[a]=!1;this.delayedKeyup={},this.presses={}},touchStart:function(a,b){return this.actions[b]=!0,this.presses[b]=!0,a.stopPropagation(),a.preventDefault(),!1},touchEnd:function(a,b){return this.delayedKeyup[b]=!0,a.stopPropagation(),a.preventDefault(),!1}})}),ig.baked=!0,ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){"use strict";ig.main=function(a,b,c,d,e,f,g){ig.system=new ig.System(a,c,d,e,f||1),ig.input=new ig.Input,ig.soundManager=new ig.SoundManager,ig.music=new ig.Music,ig.ready=!0;var h=new(g||ig.Loader)(b,ig.resources);h.load()}}),ig.baked=!0,ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){"use strict";ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(a,b,c){this.width=b,this.height=c,this.image=new ig.Image(a)}}),ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(a,b,c,d){this.sheet=a,this.pivot={x:a.width/2,y:a.height/2},this.timer=new ig.Timer,this.frameTime=b,this.sequence=c,this.stop=!!d,this.tile=this.sequence[0]},rewind:function(){return this.timer.set(),this.loopCount=0,this.tile=this.sequence[0],this},gotoFrame:function(a){this.timer.set(this.frameTime*-a),this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var a=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(a/this.sequence.length),this.frame=this.stop&&this.loopCount>0?this.sequence.length-1:a%this.sequence.length,this.tile=this.sequence[this.frame]},draw:function(a,b){var c=Math.max(this.sheet.width,this.sheet.height);a>ig.system.width||b>ig.system.height||0>a+c||0>b+c||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(a,b,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(a+this.pivot.x),ig.system.getDrawPos(b+this.pivot.y)),ig.system.context.rotate(this.angle),this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})}),ig.baked=!0,ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){"use strict";ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:44..toRad(),max:136..toRad()},init:function(a,b,c){this.id=++ig.Entity._lastId,this.pos.x=a,this.pos.y=b,ig.merge(this,c)},addAnim:function(a,b,c,d){if(!this.animSheet)throw"No animSheet to add the animation "+a+" to.";var e=new ig.Animation(this.animSheet,b,c,d);return this.anims[a]=e,this.currentAnim||(this.currentAnim=e),e},update:function(){this.last.x=this.pos.x,this.last.y=this.pos.y,this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor,this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x),this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var a=this.vel.x*ig.system.tick,b=this.vel.y*ig.system.tick,c=ig.game.collisionMap.trace(this.pos.x,this.pos.y,a,b,this.size.x,this.size.y);this.handleMovementTrace(c),this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(a,b,c,d){if(b)return(a+b*ig.system.tick).limit(-d,d);if(c){var e=c*ig.system.tick;return a-e>0?a-e:0>a+e?a+e:0}return a.limit(-d,d)},handleMovementTrace:function(a){if(this.standing=!1,a.collision.y&&(this.bounciness>0&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(this.vel.y>0&&(this.standing=!0),this.vel.y=0)),a.collision.x&&(this.bounciness>0&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*=-this.bounciness:this.vel.x=0),a.collision.slope){var b=a.collision.slope;if(this.bounciness>0){var c=this.vel.x*b.nx+this.vel.y*b.ny;this.vel.x=(this.vel.x-2*b.nx*c)*this.bounciness,this.vel.y=(this.vel.y-2*b.ny*c)*this.bounciness}else{var d=b.x*b.x+b.y*b.y,e=(this.vel.x*b.x+this.vel.y*b.y)/d;this.vel.x=b.x*e,this.vel.y=b.y*e;var f=Math.atan2(b.x,b.y);f>this.slopeStanding.min&&f<this.slopeStanding.max&&(this.standing=!0)}}this.pos=a.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(a){this.health-=a,this.health<=0&&this.kill()},touches:function(a){return!(this.pos.x>=a.pos.x+a.size.x||this.pos.x+this.size.x<=a.pos.x||this.pos.y>=a.pos.y+a.size.y||this.pos.y+this.size.y<=a.pos.y)},distanceTo:function(a){var b=this.pos.x+this.size.x/2-(a.pos.x+a.size.x/2),c=this.pos.y+this.size.y/2-(a.pos.y+a.size.y/2);return Math.sqrt(b*b+c*c)},angleTo:function(a){return Math.atan2(a.pos.y+a.size.y/2-(this.pos.y+this.size.y/2),a.pos.x+a.size.x/2-(this.pos.x+this.size.x/2))},check:function(){},collideWith:function(){},ready:function(){}}),ig.Entity._lastId=0,ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8},ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3},ig.Entity.checkPair=function(a,b){a.checkAgainst&b.type&&a.check(b),b.checkAgainst&a.type&&b.check(a),a.collides&&b.collides&&a.collides+b.collides>ig.Entity.COLLIDES.ACTIVE&&ig.Entity.solveCollision(a,b)},ig.Entity.solveCollision=function(a,b){var c=null;a.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED?c=a:(b.collides==ig.Entity.COLLIDES.LITE||a.collides==ig.Entity.COLLIDES.FIXED)&&(c=b),a.last.x+a.size.x>b.last.x&&a.last.x<b.last.x+b.size.x?(a.last.y<b.last.y?ig.Entity.seperateOnYAxis(a,b,c):ig.Entity.seperateOnYAxis(b,a,c),a.collideWith(b,"y"),b.collideWith(a,"y")):a.last.y+a.size.y>b.last.y&&a.last.y<b.last.y+b.size.y&&(a.last.x<b.last.x?ig.Entity.seperateOnXAxis(a,b,c):ig.Entity.seperateOnXAxis(b,a,c),a.collideWith(b,"x"),b.collideWith(a,"x"))},ig.Entity.seperateOnXAxis=function(a,b,c){var d=a.pos.x+a.size.x-b.pos.x;if(c){var e=a===c?b:a;c.vel.x=-c.vel.x*c.bounciness+e.vel.x;var f=ig.game.collisionMap.trace(c.pos.x,c.pos.y,c==a?-d:d,0,c.size.x,c.size.y);c.pos.x=f.pos.x}else{var g=(a.vel.x-b.vel.x)/2;a.vel.x=-g,b.vel.x=g;var h=ig.game.collisionMap.trace(a.pos.x,a.pos.y,-d/2,0,a.size.x,a.size.y);a.pos.x=Math.floor(h.pos.x);var i=ig.game.collisionMap.trace(b.pos.x,b.pos.y,d/2,0,b.size.x,b.size.y);b.pos.x=Math.ceil(i.pos.x)}},ig.Entity.seperateOnYAxis=function(a,b,c){var d=a.pos.y+a.size.y-b.pos.y;if(c){var e=a===c?b:a;c.vel.y=-c.vel.y*c.bounciness+e.vel.y;var f=0;c==a&&Math.abs(c.vel.y-e.vel.y)<c.minBounceVelocity&&(c.standing=!0,f=e.vel.x*ig.system.tick);
var g=ig.game.collisionMap.trace(c.pos.x,c.pos.y,f,c==a?-d:d,c.size.x,c.size.y);c.pos.y=g.pos.y,c.pos.x=g.pos.x}else if(ig.game.gravity&&(b.standing||a.vel.y>0)){var h=ig.game.collisionMap.trace(a.pos.x,a.pos.y,0,-(a.pos.y+a.size.y-b.pos.y),a.size.x,a.size.y);a.pos.y=h.pos.y,a.bounciness>0&&a.vel.y>a.minBounceVelocity?a.vel.y*=-a.bounciness:(a.standing=!0,a.vel.y=0)}else{var i=(a.vel.y-b.vel.y)/2;a.vel.y=-i,b.vel.y=i;var f=b.vel.x*ig.system.tick,h=ig.game.collisionMap.trace(a.pos.x,a.pos.y,f,-d/2,a.size.x,a.size.y);a.pos.y=h.pos.y;var j=ig.game.collisionMap.trace(b.pos.x,b.pos.y,0,d/2,b.size.x,b.size.y);b.pos.y=j.pos.y}}}),ig.baked=!0,ig.module("impact.map").defines(function(){"use strict";ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(a,b){this.tilesize=a,this.data=b,this.height=b.length,this.width=b[0].length},getTile:function(a,b){var c=Math.floor(a/this.tilesize),d=Math.floor(b/this.tilesize);return c>=0&&c<this.width&&d>=0&&d<this.height?this.data[d][c]:0},setTile:function(a,b,c){var d=Math.floor(a/this.tilesize),e=Math.floor(b/this.tilesize);d>=0&&d<this.width&&e>=0&&e<this.height&&(this.data[e][d]=c)}})}),ig.baked=!0,ig.module("impact.collision-map").requires("impact.map").defines(function(){"use strict";ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(a,b,c){this.parent(a,b),this.tiledef=c||ig.CollisionMap.defaultTileDef;for(var d in this.tiledef)d|0>this.lastSlope&&(this.lastSlope=0|d)},trace:function(a,b,c,d,e,f){var g={collision:{x:!1,y:!1,slope:!1},pos:{x:a,y:b},tile:{x:0,y:0}},h=Math.ceil(Math.max(Math.abs(c),Math.abs(d))/this.tilesize);if(h>1)for(var i=c/h,j=d/h,k=0;h>k&&(i||j)&&(this._traceStep(g,a,b,i,j,e,f,c,d,k),a=g.pos.x,b=g.pos.y,g.collision.x&&(i=0,c=0),g.collision.y&&(j=0,d=0),!g.collision.slope);k++);else this._traceStep(g,a,b,c,d,e,f,c,d,0);return g},_traceStep:function(a,b,c,d,e,f,g,h,i,j){a.pos.x+=d,a.pos.y+=e;var k=0;if(d){var l=d>0?f:0,m=0>d?this.tilesize:0,n=Math.max(Math.floor(c/this.tilesize),0),o=Math.min(Math.ceil((c+g)/this.tilesize),this.height),p=Math.floor((a.pos.x+l)/this.tilesize),q=Math.floor((b+l)/this.tilesize);if((j>0||p==q||0>q||q>=this.width)&&(q=-1),p>=0&&p<this.width)for(var r=n;o>r&&!(-1!=q&&(k=this.data[r][q],k>1&&k<=this.lastSlope&&this._checkTileDef(a,k,b,c,h,i,f,g,q,r)));r++)if(k=this.data[r][p],1==k||k>this.lastSlope||k>1&&this._checkTileDef(a,k,b,c,h,i,f,g,p,r)){if(k>1&&k<=this.lastSlope&&a.collision.slope)break;a.collision.x=!0,a.tile.x=k,b=a.pos.x=p*this.tilesize-l+m,h=0;break}}if(e){var s=e>0?g:0,t=0>e?this.tilesize:0,u=Math.max(Math.floor(a.pos.x/this.tilesize),0),v=Math.min(Math.ceil((a.pos.x+f)/this.tilesize),this.width),r=Math.floor((a.pos.y+s)/this.tilesize),w=Math.floor((c+s)/this.tilesize);if((j>0||r==w||0>w||w>=this.height)&&(w=-1),r>=0&&r<this.height)for(var p=u;v>p&&!(-1!=w&&(k=this.data[w][p],k>1&&k<=this.lastSlope&&this._checkTileDef(a,k,b,c,h,i,f,g,p,w)));p++)if(k=this.data[r][p],1==k||k>this.lastSlope||k>1&&this._checkTileDef(a,k,b,c,h,i,f,g,p,r)){if(k>1&&k<=this.lastSlope&&a.collision.slope)break;a.collision.y=!0,a.tile.y=k,a.pos.y=r*this.tilesize-s+t;break}}},_checkTileDef:function(a,b,c,d,e,f,g,h,i,j){var k=this.tiledef[b];if(!k)return!1;var l=(i+k[0])*this.tilesize,m=(j+k[1])*this.tilesize,n=(k[2]-k[0])*this.tilesize,o=(k[3]-k[1])*this.tilesize,p=k[4],q=c+e+(0>o?g:0)-l,r=d+f+(n>0?h:0)-m;if(n*r-o*q>0){if(0>e*-o+f*n)return p;var s=Math.sqrt(n*n+o*o),t=o/s,u=-n/s,v=q*t+r*u,w=t*v,x=u*v;return w*w+x*x>=e*e+f*f?p||.5>n*(r-f)-o*(q-e):(a.pos.x=c+e-w,a.pos.y=d+f-x,a.collision.slope={x:n,y:o,nx:t,ny:u},!0)}return!1}});var a=.5,b=1/3,c=2/3,d=!0,e=!1;ig.CollisionMap.defaultTileDef={5:[0,1,1,c,d],6:[0,c,1,b,d],7:[0,b,1,0,d],3:[0,1,1,a,d],4:[0,a,1,0,d],2:[0,1,1,0,d],10:[a,1,1,0,d],21:[0,1,a,0,d],32:[c,1,1,0,d],43:[b,1,c,0,d],54:[0,1,b,0,d],27:[0,0,1,b,d],28:[0,b,1,c,d],29:[0,c,1,1,d],25:[0,0,1,a,d],26:[0,a,1,1,d],24:[0,0,1,1,d],11:[0,0,a,1,d],22:[a,0,1,1,d],33:[0,0,b,1,d],44:[b,0,c,1,d],55:[c,0,1,1,d],16:[1,b,0,0,d],17:[1,c,0,b,d],18:[1,1,0,c,d],14:[1,a,0,0,d],15:[1,1,0,a,d],13:[1,1,0,0,d],8:[a,1,0,0,d],19:[1,1,a,0,d],30:[b,1,0,0,d],41:[c,1,b,0,d],52:[1,1,c,0,d],38:[1,c,0,1,d],39:[1,b,0,c,d],40:[1,0,0,b,d],36:[1,a,0,1,d],37:[1,0,0,a,d],35:[1,0,0,1,d],9:[1,0,a,1,d],20:[a,0,0,1,d],31:[1,0,c,1,d],42:[c,0,b,1,d],53:[b,0,0,1,d],12:[0,0,1,0,e],23:[1,1,0,1,e],34:[1,0,1,1,e],45:[0,1,0,0,e]},ig.CollisionMap.staticNoCollision={trace:function(a,b,c,d){return{collision:{x:!1,y:!1,slope:!1},pos:{x:a+c,y:b+d},tile:{x:0,y:0}}}}}),ig.baked=!0,ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){"use strict";ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(a,b,c){this.parent(a,b),this.setTileset(c)},setTileset:function(a){this.tilesetName=a instanceof ig.Image?a.path:a,this.tiles=new ig.Image(this.tilesetName),this.preRenderedChunks=null},setScreenPos:function(a,b){this.scroll.x=a/this.distance,this.scroll.y=b/this.distance},preRenderMapToChunks:function(){var a=this.width*this.tilesize*ig.system.scale,b=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(a,b),this.chunkSize);var c=Math.ceil(a/this.chunkSize),d=Math.ceil(b/this.chunkSize);this.preRenderedChunks=[];for(var e=0;d>e;e++){this.preRenderedChunks[e]=[];for(var f=0;c>f;f++){var g=f==c-1?a-f*this.chunkSize:this.chunkSize,h=e==d-1?b-e*this.chunkSize:this.chunkSize;this.preRenderedChunks[e][f]=this.preRenderChunk(f,e,g,h)}}},preRenderChunk:function(a,b,c,d){var e=c/this.tilesize/ig.system.scale+1,f=d/this.tilesize/ig.system.scale+1,g=a*this.chunkSize/ig.system.scale%this.tilesize,h=b*this.chunkSize/ig.system.scale%this.tilesize,i=Math.floor(a*this.chunkSize/this.tilesize/ig.system.scale),j=Math.floor(b*this.chunkSize/this.tilesize/ig.system.scale),k=ig.$new("canvas");k.width=c,k.height=d;var l=ig.system.context;ig.system.context=k.getContext("2d");for(var m=0;e>m;m++)for(var n=0;f>n;n++)if(m+i<this.width&&n+j<this.height){var o=this.data[n+j][m+i];o&&this.tiles.drawTile(m*this.tilesize-g,n*this.tilesize-h,o-1,this.tilesize)}return ig.system.context=l,k},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var a=ig.system.getDrawPos(this.scroll.x),b=ig.system.getDrawPos(this.scroll.y);if(this.repeat){var c=this.width*this.tilesize*ig.system.scale;a=(a%c+c)%c;var d=this.height*this.tilesize*ig.system.scale;b=(b%d+d)%d}var e=Math.max(Math.floor(a/this.chunkSize),0),f=Math.max(Math.floor(b/this.chunkSize),0),g=Math.ceil((a+ig.system.realWidth)/this.chunkSize),h=Math.ceil((b+ig.system.realHeight)/this.chunkSize),i=this.preRenderedChunks[0].length,j=this.preRenderedChunks.length;this.repeat||(g=Math.min(g,i),h=Math.min(h,j));for(var k=0,l=f;h>l;l++){for(var m=0,n=e;g>n;n++){var o=this.preRenderedChunks[l%j][n%i],p=-a+n*this.chunkSize-m,q=-b+l*this.chunkSize-k;ig.system.context.drawImage(o,p,q),ig.Image.drawCount++,this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(p,q,this.chunkSize,this.chunkSize)),this.repeat&&o.width<this.chunkSize&&p+o.width<ig.system.realWidth&&(m+=this.chunkSize-o.width,g++)}this.repeat&&o.height<this.chunkSize&&q+o.height<ig.system.realHeight&&(k+=this.chunkSize-o.height,h++)}},drawTiled:function(){for(var a=0,b=null,c=(this.scroll.x/this.tilesize).toInt(),d=(this.scroll.y/this.tilesize).toInt(),e=this.scroll.x%this.tilesize,f=this.scroll.y%this.tilesize,g=-e-this.tilesize,h=-f-this.tilesize,i=ig.system.width+this.tilesize-e,j=ig.system.height+this.tilesize-f,k=-1,l=h;j>l;k++,l+=this.tilesize){var m=k+d;if(m>=this.height||0>m){if(!this.repeat)continue;m=(m%this.height+this.height)%this.height}for(var n=-1,o=g;i>o;n++,o+=this.tilesize){var p=n+c;if(p>=this.width||0>p){if(!this.repeat)continue;p=(p%this.width+this.width)%this.width}(a=this.data[m][p])&&((b=this.anims[a-1])?b.draw(o,l):this.tiles.drawTile(o,l,a-1,this.tilesize))}}}})}),ig.baked=!0,ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){"use strict";ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){return this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX,ig.game=this,null},loadLevel:function(a){this.screen={x:0,y:0},this.entities=[],this.namedEntities={};for(var b=0;b<a.entities.length;b++){var c=a.entities[b];this.spawnEntity(c.type,c.x,c.y,c.settings)}this.sortEntities(),this.collisionMap=ig.CollisionMap.staticNoCollision,this.backgroundMaps=[];for(var b=0;b<a.layer.length;b++){var d=a.layer[b];if("collision"==d.name)this.collisionMap=new ig.CollisionMap(d.tilesize,d.data);else{var e=new ig.BackgroundMap(d.tilesize,d.data,d.tilesetName);e.anims=this.backgroundAnims[d.tilesetName]||{},e.repeat=d.repeat,e.distance=d.distance,e.foreground=!!d.foreground,e.preRender=!!d.preRender,e.name=d.name,this.backgroundMaps.push(e)}}for(var b=0;b<this.entities.length;b++)this.entities[b].ready()},loadLevelDeferred:function(a){this._levelToLoad=a},getMapByName:function(a){if("collision"==a)return this.collisionMap;for(var b=0;b<this.backgroundMaps.length;b++)if(this.backgroundMaps[b].name==a)return this.backgroundMaps[b];return null},getEntityByName:function(a){return this.namedEntities[a]},getEntitiesByType:function(a){for(var b="string"==typeof a?ig.global[a]:a,c=[],d=0;d<this.entities.length;d++){var e=this.entities[d];e instanceof b&&!e._killed&&c.push(e)}return c},spawnEntity:function(a,b,c,d){var e="string"==typeof a?ig.global[a]:a;if(!e)throw"Can't spawn entity of type "+a;var f=new e(b,c,d||{});return this.entities.push(f),f.name&&(this.namedEntities[f.name]=f),f},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(a){a.name&&delete this.namedEntities[a.name],a._killed=!0,a.type=ig.Entity.TYPE.NONE,a.checkAgainst=ig.Entity.TYPE.NONE,a.collides=ig.Entity.COLLIDES.NEVER,this._deferredKill.push(a)},run:function(){this.update(),this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null),(this._doSortEntities||this.autoSort)&&(this.sortEntities(),this._doSortEntities=!1),this.updateEntities(),this.checkEntities();for(var a=0;a<this._deferredKill.length;a++)this.entities.erase(this._deferredKill[a]);this._deferredKill=[];for(var b in this.backgroundAnims){var c=this.backgroundAnims[b];for(var d in c)c[d].update()}},updateEntities:function(){for(var a=0;a<this.entities.length;a++){var b=this.entities[a];b._killed||b.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor),this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale,this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var a;for(a=0;a<this.backgroundMaps.length;a++){var b=this.backgroundMaps[a];if(b.foreground)break;b.setScreenPos(this.screen.x,this.screen.y),b.draw()}for(this.drawEntities(),a;a<this.backgroundMaps.length;a++){var b=this.backgroundMaps[a];b.setScreenPos(this.screen.x,this.screen.y),b.draw()}},drawEntities:function(){for(var a=0;a<this.entities.length;a++)this.entities[a].draw()},checkEntities:function(){for(var a={},b=0;b<this.entities.length;b++){var c=this.entities[b];if(c.type!=ig.Entity.TYPE.NONE||c.checkAgainst!=ig.Entity.TYPE.NONE||c.collides!=ig.Entity.COLLIDES.NEVER)for(var d={},e=Math.floor(c.pos.x/this.cellSize),f=Math.floor(c.pos.y/this.cellSize),g=Math.floor((c.pos.x+c.size.x)/this.cellSize)+1,h=Math.floor((c.pos.y+c.size.y)/this.cellSize)+1,i=e;g>i;i++)for(var j=f;h>j;j++)if(a[i])if(a[i][j]){for(var k=a[i][j],l=0;l<k.length;l++)c.touches(k[l])&&!d[k[l].id]&&(d[k[l].id]=!0,ig.Entity.checkPair(c,k[l]));k.push(c)}else a[i][j]=[c];else a[i]={},a[i][j]=[c]}}}),ig.Game.SORT={Z_INDEX:function(a,b){return a.zIndex-b.zIndex},POS_X:function(a,b){return a.pos.x+a.size.x-(b.pos.x+b.size.x)},POS_Y:function(a,b){return a.pos.y+a.size.y-(b.pos.y+b.size.y)}}}),ig.baked=!0,ig.module("bootstrap.plugins.resize").requires("impact.system").defines(function(){ig.resizeGame=function(){var a=ig.system.canvas,b=a.width/a.height,c=window.innerWidth,d=window.innerHeight,e=c/d;e>b?(c=d*b,a.style.height=d+"px",a.style.width=c+"px"):(d=c/b,a.style.width=c+"px",a.style.height=d+"px"),a.style.top=(window.innerHeight-d)/2+"px",a.style.left=(window.innerWidth-c)/2+"px"},window.addEventListener("resize",ig.resizeGame,!1)}),ig.baked=!0,ig.module("bootstrap.plugins.hit-area").requires("impact.input").defines(function(){!function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1});var a=["PointerDown","PointerUp","PointerMove","PointerOver","PointerOut","PointerCancel","PointerEnter","PointerLeave","pointerdown","pointerup","pointermove","pointerover","pointerout","pointercancel","pointerenter","pointerleave"],b="touch",c="pen",d="mouse",e={},f=function(a,e){var f;if(document.createEvent?(f=document.createEvent("MouseEvents"),f.initMouseEvent(e,!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,null)):(f=document.createEventObject(),f.screenX=a.screenX,f.screenY=a.screenY,f.clientX=a.clientX,f.clientY=a.clientY,f.ctrlKey=a.ctrlKey,f.altKey=a.altKey,f.shiftKey=a.shiftKey,f.metaKey=a.metaKey,f.button=a.button),void 0===f.offsetX&&(void 0!==a.offsetX?(Object&&void 0!==Object.defineProperty&&(Object.defineProperty(f,"offsetX",{writable:!0}),Object.defineProperty(f,"offsetY",{writable:!0})),f.offsetX=a.offsetX,f.offsetY=a.offsetY):void 0!==a.layerX&&(f.offsetX=a.layerX-a.currentTarget.offsetLeft,f.offsetY=a.layerY-a.currentTarget.offsetTop)),f.isPrimary=void 0!==a.isPrimary?a.isPrimary:!0,a.pressure)f.pressure=a.pressure;else{var g=0;void 0!==a.which?g=a.which:void 0!==a.button&&(g=a.button),f.pressure=0==g?0:.5}switch(f.rotation=a.rotation?a.rotation:0,f.hwTimestamp=a.hwTimestamp?a.hwTimestamp:0,f.tiltX=a.tiltX?a.tiltX:0,f.tiltY=a.tiltY?a.tiltY:0,f.height=a.height?a.height:0,f.width=a.width?a.width:0,f.preventDefault=function(){void 0!==a.preventDefault&&a.preventDefault()},f.POINTER_TYPE_TOUCH=b,f.POINTER_TYPE_PEN=c,f.POINTER_TYPE_MOUSE=d,f.pointerId=a.pointerId,f.pointerType=a.pointerType,f.pointerType){case 2:f.pointerType=f.POINTER_TYPE_TOUCH;break;case 3:f.pointerType=f.POINTER_TYPE_PEN;break;case 4:f.pointerType=f.POINTER_TYPE_MOUSE}a.currentTarget&&a.currentTarget.handjs_forcePreventDefault===!0&&f.preventDefault(),a.target?a.target.dispatchEvent(f):a.srcElement.fireEvent("on"+k(e),f)},g=function(a,b){a.pointerId=1,a.pointerType=d,f(a,b)},h=function(a,c,d,e){var g=c.identifier+2;c.pointerId=g,c.pointerType=b,c.currentTarget=d,c.target=d,void 0!==e.preventDefault&&(c.preventDefault=function(){e.preventDefault()}),f(c,a)},i=function(a,b,c,d){if(c._handjs_registeredEvents)for(var e=0;e<c._handjs_registeredEvents.length;e++)c._handjs_registeredEvents[e].toLowerCase()===a&&h(c._handjs_registeredEvents[e],b,c,d)},j=function(a,b,c,d){a.preventManipulation&&a.preventManipulation();for(var f=0;f<a.changedTouches.length;++f){var g=a.changedTouches[f];c&&(e[g.identifier]=g.target),d?i(b,g,e[g.identifier],a):h(b,g,e[g.identifier],a)}},k=function(a){return a.toLowerCase().replace("pointer","mouse")},l=function(b,c,d){var e;if(d==d.toLowerCase()){var f=a.indexOf(d)-a.length/2;e=c+a[f]}else e=c+d;return e===c+"PointerEnter"&&void 0===b["on"+c.toLowerCase()+"pointerenter"]&&(e=c+"PointerOver"),e===c+"PointerLeave"&&void 0===b["on"+c.toLowerCase()+"pointerleave"]&&(e=c+"PointerOut"),e},m=function(a,b,c,d){d?a.addEventListener(b,c,!1):a.removeEventListener(b,c)},n=function(a,b,c){if(void 0===a.onpointerdown){if(void 0!==a.onmspointerdown){var d=l(a,"MS",b);return m(a,d,function(a){f(a,b)},c),void 0}if(void 0!==a.ontouchstart)switch(b.toLowerCase()){case"pointermove":m(a,"touchmove",function(a){j(a,b)},c);break;case"pointercancel":m(a,"touchcancel",function(a){j(a,b)},c);break;case"pointerdown":case"pointerup":case"pointerout":case"pointerover":case"pointerleave":case"pointerenter":a._handjs_registeredEvents||(a._handjs_registeredEvents=[]);var e=a._handjs_registeredEvents.indexOf(b);c?-1===e&&a._handjs_registeredEvents.push(b):a._handjs_registeredEvents.splice(e,1)}switch(b.toLowerCase()){case"pointerdown":m(a,"mousedown",function(a){g(a,b)},c);break;case"pointermove":m(a,"mousemove",function(a){g(a,b)},c);break;case"pointerup":m(a,"mouseup",function(a){g(a,b)},c);break;case"pointerover":m(a,"mouseover",function(a){g(a,b)},c);break;case"pointerout":m(a,"mouseout",function(a){g(a,b)},c);break;case"pointerenter":void 0===a.onmouseenter?m(a,"mouseover",function(a){g(a,b)},c):m(a,"mouseenter",function(a){g(a,b)},c);break;case"pointerleave":void 0===a.onmouseleave?m(a,"mouseout",function(a){g(a,b)},c):m(a,"mouseleave",function(a){g(a,b)},c)}}},o=function(b){var c=b.prototype?b.prototype.addEventListener:b.addEventListener,d=function(b,d,e){-1!=a.indexOf(b)&&n(this,b,!0),void 0===c?this.attachEvent("on"+k(b),d):c.call(this,b,d,e)};b.prototype?b.prototype.addEventListener=d:b.addEventListener=d},p=function(b){var c=b.prototype?b.prototype.removeEventListener:b.removeEventListener,d=function(b,d,e){-1!=a.indexOf(b)&&n(this,b,!1),void 0===c?this.detachEvent(k(b),d):c.call(this,b,d,e)};b.prototype?b.prototype.removeEventListener=d:b.removeEventListener=d};o(document),o(HTMLBodyElement),o(HTMLDivElement),o(HTMLImageElement),o(HTMLSpanElement),o(HTMLUListElement),o(HTMLAnchorElement),o(HTMLLIElement),window.HTMLCanvasElement&&o(HTMLCanvasElement),window.SVGElement&&o(SVGElement),p(document),p(HTMLBodyElement),p(HTMLDivElement),p(HTMLImageElement),p(HTMLSpanElement),p(HTMLUListElement),p(HTMLAnchorElement),p(HTMLLIElement),window.HTMLCanvasElement&&p(HTMLCanvasElement),window.SVGElement&&p(SVGElement),void 0!==window.ontouchstart&&(window.addEventListener("touchstart",function(a){for(var b=0;b<a.changedTouches.length;++b){var c=a.changedTouches[b];e[c.identifier]=c.target,i("pointerenter",c,c.target,a),i("pointerover",c,c.target,a),i("pointerdown",c,c.target,a)}}),window.addEventListener("touchend",function(a){for(var b=0;b<a.changedTouches.length;++b){var c=a.changedTouches[b],d=e[c.identifier];i("pointerup",c,d,a),i("pointerout",c,d,a),i("pointerleave",c,d,a)}}),window.addEventListener("touchmove",function(a){for(var b=0;b<a.changedTouches.length;++b){var c=a.changedTouches[b],d=document.elementFromPoint(c.clientX,c.clientY),f=e[c.identifier];f!==d&&(f&&(i("pointerout",c,f,a),f.contains(d)||i("pointerleave",c,f,a)),d&&(i("pointerover",c,d,a),d.contains(f)||i("pointerenter",c,d,a)),e[c.identifier]=d)}})),void 0===navigator.pointerEnabled&&(navigator.pointerEnabled=!0,navigator.msPointerEnabled&&(navigator.maxTouchPoints=navigator.msMaxTouchPoints)),document.styleSheets&&document.addEventListener&&document.addEventListener("DOMContentLoaded",function(){var a=function(a){return a.replace(/^\s+|\s+$/,"")},b=function(b){for(var c=new RegExp(".+?{.*?}","m"),d=new RegExp(".+?{","m");""!=b;){var e=c.exec(b)[0];b=a(b.replace(e,""));var f=a(d.exec(e)[0].replace("{",""));if(-1!=e.replace(/\s/g,"").indexOf("touch-action:none"))for(var g=document.querySelectorAll(f),h=0;h<g.length;h++){var i=g[h];void 0!==i.style.msTouchAction?i.style.msTouchAction="none":i.handjs_forcePreventDefault=!0}}};try{for(var c=0;c<document.styleSheets.length;c++){var d=document.styleSheets[c];if(void 0!=d.href){var e=new XMLHttpRequest;e.open("get",d.href,!1),e.send();var f=e.responseText.replace(/(\n|\r)/g,"");b(f)}}}catch(g){}for(var h=document.getElementsByTagName("style"),c=0;c<h.length;c++){var i=h[c],j=a(i.innerHTML.replace(/(\n|\r)/g,""));b(j)}},!1)}(),ig.Input.inject({hitAreas:[],debugHitAreas:!0,pointers:{},touchType:null,init:function(){var a=ig.system.canvas;a.addEventListener("selectstart",function(a){a.preventDefault()},!1),a.addEventListener("PointerDown",this.touchStart.bind(this),!1),a.addEventListener("PointerUp",this.touchEnd.bind(this),!1),a.addEventListener("PointerMove",this.touchMove.bind(this),!1)},unbind:function(a){this.parent(a),this.removeHitArea(a)},unbindAll:function(){this.parent(),this.hitAreas=[]},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var a=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",a,!1),ig.system.canvas.addEventListener("DOMMouseScroll",a,!1),ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1)}},touchStart:function(a){a.preventDefault(),this.touchType=a.pointerType;var b=Math.round((a.x-Number(canvas.style.left.slice(0,-2)))*(ig.system.canvas.width/Number(canvas.style.width.slice(0,-2)))),c=Math.round((a.y-Number(canvas.style.top.slice(0,-2)))*(ig.system.canvas.height/Number(canvas.style.height.slice(0,-2)))),d=this.testHitAreas(b,c);this.pointers[a.pointerId]={x:b,y:c,hits:d};for(var e=d.length,f=0;e>f;f++){var g=d[f];this.actions[g]=!0,this.locks[g]||(this.presses[g]=!0,this.locks[g]=!0)}},touchMove:function(a){a.preventDefault();var b=Math.round((a.x-Number(canvas.style.left.slice(0,-2)))*(ig.system.canvas.width/Number(canvas.style.width.slice(0,-2)))),c=Math.round((a.y-Number(canvas.style.top.slice(0,-2)))*(ig.system.canvas.height/Number(canvas.style.height.slice(0,-2))));this.pointers.hasOwnProperty(a.pointerId)&&(this.pointers[a.pointerId].x=b,this.pointers[a.pointerId].y=c)},touchEnd:function(a){a.preventDefault();for(var b=this.pointers[a.pointerId].hits,c=b.length,d=0;c>d;d++){var e=b[d];this.delayedKeyup[e]=!0}delete this.pointers[a.pointerId]},registerHitArea:function(a,b,c,d,e,f,g){var h=new Rectangle(b,c,d,e,g);return h.name=a,h.touchType=f||"any",this.hitAreas.push(h),h},testHitAreas:function(a,b){var c,d=[],e=0,f=this.hitAreas.length;for(e;f>e;e++)c=this.hitAreas[e],("any"==c.touchType||c.touchType==this.touchType)&&c.contains(a,b)&&d.push(c.name);return d},getHitArea:function(a){var b,c=0,d=this.hitAreas.length;for(c;d>c;c++)if(b=this.hitAreas[c],b.name==a)return b;return null},updateHitArea:function(a,b){var c=this.getHitArea(a);if(c)for(var d in b)c[d]=b[d]},removeHitArea:function(a){var b,c=0,d=this.hitAreas.length;for(c;d>c;c++)b=this.hitAreas[c],b.name==a},clearHitAreas:function(){this.hitAreas=[]},draw:function(){var a,b=this.hitAreas.length,c=0,d=ig.system.context;for(c;b>c;c++)a=this.hitAreas[c],("left"!=a.name||"right"!=a.name)&&(d.fillStyle="rgba(0, 0, 200, 0.5)",d.fillRect(a.x,a.y,a.width,a.height))}}),Rectangle=ig.Class.extend({x:0,y:0,width:0,height:0,debugColor:16777215,top:0,right:0,bottom:0,left:0,init:function(a,b,c,d,e){this.resize(a,b,c,d),e&&(this.debugColor=e)},resize:function(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d,this.left=this.x,this.right=this.x+this.width,this.top=this.y,this.bottom=this.y+this.height},contains:function(a,b){return a>=this.x&&a<=this.right&&b>=this.y&&b<=this.bottom?!0:!1}})}),ig.baked=!0,ig.module("bootstrap.plugins.texture-atlas").requires("impact.animation","impact.image","impact.entity").defines(function(){"use strict";ig.Entity.inject({addTextureAtlasAnim:function(a,b,c,d,e,f){if(!a)throw"No texture atlas to add the animation from!";if(!b)throw"No name to call the animation!";var g=new ig.TextureAtlasAnimation(a,c,d,e,f);return this.anims[b]=g,this.currentAnim||(this.currentAnim=g),g}}),ig.TextureAtlas=ig.Image.extend({jsonData:null,frameCache:[],init:function(a,b){this.parent(a),b&&(console.log("altas data",b),this.jsonData=b)},load:function(a){if(this.loaded)return a&&a(this.path,!0),void 0;if(!this.loaded&&ig.ready){if(this.loadCallback=a||null,null==this.jsonData){var b=ig.prefix+(this.path.substr(0,this.path.lastIndexOf("."))||this.path)+".txt",c=null;if(c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),!c)throw"TextureAtlas Exception: AJAX not supported!";c.open("get",b,!1),c.send(null);try{this.jsonData=JSON.parse(c.responseText)}catch(d){console.log("Error parsing json:",d)}}this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache}else ig.addResource(this);ig.Image.cache[this.path]=this},getFrameData:function(a){if("undefined"!=typeof this.frameCache[a])return this.frameCache[a];for(var b=0;b<this.jsonData.frames.length;b++)if(this.jsonData.frames[b].filename==a)return this.frameCache[a]=this.jsonData.frames[b],this.frameCache[a];throw"TextureAtlas Exception: frame ["+a+"] does not exist!"},getWidth:function(){return this.jsonData.meta.size.w},getHeight:function(){return this.jsonData.meta.size.h},drawFrame:function(a,b,c,d,e,f){var g=this.getFrameData(a),h=b,i=c,j=null==e?g.frame.w:e,k=null==f?g.frame.h:f;g.trimmed&&d&&(h+=g.spriteSourceSize.x,i+=g.spriteSourceSize.y),this.draw(h,i,g.frame.x,g.frame.y,j,k)}}),ig.TextureAtlasAnimation=ig.Animation.extend({textureAtlas:null,maintainFrameOffset:!1,frameData:0,init:function(a,b,c,d,e){this.textureAtlas=a,this.timer=new ig.Timer,this.frameTime=b,this.sequence=c,this.frameData=this.textureAtlas.getFrameData(this.sequence[0]),this.stop=!!d,e&&(this.maintainFrameOffset=e)},rewind:function(){return this.timer.reset(),this.loopCount=0,this.frameData=this.textureAtlas.getFrameData(this.sequence[0]),this},update:function(){var a=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(a/this.sequence.length),this.frame=this.stop&&this.loopCount>0?this.sequence.length-1:a%this.sequence.length,this.frameData=this.textureAtlas.getFrameData(this.sequence[this.frame])},draw:function(a,b){var c=Math.max(this.textureAtlas.width,this.textureAtlas.height),d=a,e=b;if(this.frameData.trimmed&&this.maintainFrameOffset&&(d+=this.frameData.spriteSourceSize.x,e+=this.frameData.spriteSourceSize.y),!(d>ig.system.width||e>ig.system.height||0>d+c||0>e+c)){1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha);var f=this.frameData.frame.w/2,g=this.frameData.frame.h/2;ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(d+f),ig.system.getDrawPos(e+g)),ig.system.context.rotate(this.angle);var h=this.flip.x?-1:1,i=this.flip.y?-1:1;(this.flip.x||this.flip.y)&&ig.system.context.scale(h,i),this.textureAtlas.draw(-f,-g,this.frameData.frame.x,this.frameData.frame.y,this.frameData.frame.w,this.frameData.frame.h),ig.system.context.restore(),1!=this.alpha&&(ig.system.context.globalAlpha=1)}}}),ig.TextureAtlasImage=ig.Image.extend({textureAtlas:null,frameName:null,maintainFrameOffset:!1,init:function(a,b){this.frameName=b,this.textureAtlas=a;var c=this.textureAtlas.getFrameData(b);this.width=c.frame.w,this.height=c.frame.h},draw:function(a,b){this.textureAtlas.drawFrame(this.frameName,a,b)}})}),ig.baked=!0,ig.module("bootstrap.plugins.menu").requires("impact.game","impact.font").defines(function(){ig.Game.inject({activeMenu:null,draw:function(){this.parent(),this.activeMenu&&this.activeMenu.draw()},showMenu:function(a){a.draw&&(this.activeMenu=a)},hideMenu:function(){this.activeMenu=null},loadLevel:function(a){this.hideMenu(),this.parent(a)}}),Menu=ig.Class.extend({menuFont:null,title:null,init:function(a){this.title=a?a:"Menu Title"},draw:function(){this.drawModal();var a=.5*ig.system.width,b=.5*ig.system.height;this.menuFont&&this.menuFont.draw(this.title,a,b,ig.Font.ALIGN.CENTER)},drawModal:function(a){a||(a="rgba(0,0,0,0.8)"),ig.system.context.fillStyle=a,ig.system.context.fillRect(0,0,ig.system.width*ig.system.scale,ig.system.height*ig.system.scale)}})}),ig.baked=!0,ig.module("bootstrap.plugins.pause").requires("impact.game","impact.timer","bootstrap.plugins.menu").defines(function(){ig.Game.inject({paused:!1,pauseDelayTimer:new ig.Timer,pauseButtonDelay:.5,updateEntities:function(){for(var a=0;a<this.entities.length;a++){var b=this.entities[a];b._killed||this.paused?b.ignorePause&&b.update():b.update()}},togglePause:function(a){this.pauseDelayTimer.delta()>this.pauseButtonDelay&&(this.paused=null!=a?a:!this.paused,this.paused?this.onPause():this.onResume(),this.pauseDelayTimer.reset())},onResume:function(){this.hideMenu&&this.hideMenu()},onPause:function(){this.showMenu&&this.onShowPauseMenu()},onShowPauseMenu:function(){this.showMenu(new Menu("Pause"))}}),ig.Entity.inject({ignorePause:!1})}),ig.baked=!0,ig.module("bootstrap.platforms.win8").requires("bootstrap.plugins.resize","impact.input","impact.game").defines(function(){if("undefined"!=typeof WinJS){var a=WinJS.Application,b=Windows.ApplicationModel.Activation,c=null;initLicense=function(){return c=Windows.ApplicationModel.Store.CurrentApp,c.licenseInformation},licenseInfo=initLicense(),win8ResizeGame=function(){var a=Windows.UI.ViewManagement.ApplicationViewState,b=Windows.UI.ViewManagement.ApplicationView.value;b===a.snapped&&ig.game.togglePause(!0),ig.resizeGame()},sendToStore=function(){var a=new Windows.Foundation.Uri(c.linkUri.rawUri);Windows.System.Launcher.launchUriAsync(a)},a.onactivated=function(a){if(a.detail.kind===b.ActivationKind.launch){if(a.detail.previousExecutionState!==b.ApplicationExecutionState.terminated){window.addEventListener("resize",win8ResizeGame,!1);var c=document.getElementById("snap-view");c.addEventListener("click",function(){Windows.UI.ViewManagement.ApplicationView.tryUnsnap()}),ig.startNewGame(800,480)}a.setPromise(WinJS.UI.processAll())}WinJS.Application.onsettings=function(a){a.detail.applicationcommands={privacyPolicy:{title:"Privacy Policy",href:"privacy.html"}},WinJS.UI.SettingsFlyout.populateSettings(a)}}}}),ig.baked=!0,ig.module("bootstrap.plugins.utils").requires("impact.game").defines(function(){ig.utils={},String.prototype.pad=function(a,b){return(a-=this.length)>0?(b=new Array(Math.ceil(a/b.length)+1).join(b)).substr(0,b.length)+this+b.substr(0,a-b.length):this},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},ig.utils.randomRange=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},Array.prototype.shuffle=function(){var a,b,c,d=this.length;if(0==d)return!1;for(;--d;)a=Math.floor(Math.random()*(d+1)),b=this[d],c=this[a],this[d]=c,this[a]=b;return this},String.prototype.fromatTime=function(){sec_numb=parseInt(this);var a=Math.floor(sec_numb/3600),b=Math.floor((sec_numb-3600*a)/60),c=sec_numb-3600*a-60*b;10>b&&(b="0"+b),10>c&&(c="0"+c);var d=b+":"+c;return d},ig.Game.inject({currentLevelName:null,loadLevelByFileName:function(a,b){this.currentLevelName=a.replace(/^(Level)?(\w)(\w*)/,function(a,b,c,d){return c.toUpperCase()+d}).replace(".js","");var c=ig.global["Level"+this.currentLevelName];this[b?"loadLevelDeferred":"loadLevel"](c)}})}),ig.baked=!0,ig.module("game.entities.death-explosion").requires("impact.entity").defines(function(){EntityDeathExplosion=ig.Entity.extend({_wmIgnore:!0,delay:1,callBack:null,particles:25,init:function(a,b,c){this.parent(a,b,c);for(var d=0;d<this.particles;d++)ig.game.spawnEntity(EntityDeathExplosionParticle,a,b,{colorOffset:c.colorOffset?c.colorOffset:0});this.idleTimer=new ig.Timer},update:function(){return this.idleTimer.delta()>this.delay?(this.kill(),this.callBack&&this.callBack(),void 0):void 0}}),EntityDeathExplosionParticle=ig.Entity.extend({_wmIgnore:!0,size:{x:20,y:20},bounceFX:new ig.Sound("media/sounds/bounce.*"),delay:2,fadetime:1,bounciness:0,maxVel:{x:50,y:150},vel:{x:40,y:0},friction:{x:100,y:10},collides:ig.Entity.COLLIDES.NONE,colorOffset:0,totalColors:7,baseVelocity:{x:4,y:20},zindex:10,bounciness:.3,maxBouncesSounds:1,animSheet:animSheet=new ig.AnimationSheet("media/sprites/blood-particle.png",20,20),init:function(a,b,c){this.parent(a,b,c);
var d=c.flip?1:-1;this.configureAnimation(),this.vel.x=d*(Math.random()*this.baseVelocity.x-1)*this.vel.x,this.vel.y=-(Math.random()*this.baseVelocity.y-1)*this.vel.y,this.idleTimer=new ig.Timer},configureAnimation:function(){var a=Math.round(Math.random()*this.totalColors)+this.colorOffset*(this.totalColors+1);this.addAnim("idle",1,[a])},update:function(){return this.idleTimer.delta()>this.delay?(this.kill(),void 0):(this.currentAnim.alpha=this.idleTimer.delta().map(this.delay-this.fadetime,this.delay,1,0),this.parent(),void 0)},handleMovementTrace:function(a){this.parent(a),(a.collision.x||a.collision.y)&&this.bounce()},bounce:function(){this.maxBouncesSounds--,this.maxBouncesSounds>0&&this.bounceFX.play()}}),EntityDeathExplosionSmallParticle=EntityDeathExplosionParticle.extend({size:{x:5,y:5},animSheet:new ig.AnimationSheet("media/sprites/particles.png",5,5)}),ig.Entity.inject({bloodColorOffset:0,bloodEntity:"EntityDeathExplosionParticle",spawnParticles:function(a){for(var b=0;a>b;b++)ig.game.spawnEntity(this.bloodEntity,this.pos.x+(this.flip?this.size.x:0),this.pos.y+.2*this.size.y,{flip:this.flip})},receiveDamage:function(a,b){this.parent(a,b),this.health>0&&this.spawnParticles(2)}})}),ig.baked=!0,ig.module("plugins.ease-pack").defines(function(){(window._gsQueue||(window._gsQueue=[])).push(function(){_gsDefine("easing.Back",["easing.Ease"],function(a){var b=window.com.greensock._class,c=function(c,d){var e=b("easing."+c,function(){},!0),f=e.prototype=new a;return f.constructor=e,f.getRatio=d,e},d=function(c,d){var e=b("easing."+c,function(a){this._p1=a||0===a?a:1.70158,this._p2=1.525*this._p1},!0),f=e.prototype=new a;return f.constructor=e,f.getRatio=d,f.config=function(a){return new e(a)},e},e=d("BackOut",function(a){return(a-=1)*a*((this._p1+1)*a+this._p1)+1}),f=d("BackIn",function(a){return a*a*((this._p1+1)*a-this._p1)}),d=d("BackInOut",function(a){return 1>(a*=2)?.5*a*a*((this._p2+1)*a-this._p2):.5*((a-=2)*a*((this._p2+1)*a+this._p2)+2)}),g=c("BounceOut",function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}),h=c("BounceIn",function(a){return(a=1-a)<1/2.75?1-7.5625*a*a:2/2.75>a?1-(7.5625*(a-=1.5/2.75)*a+.75):2.5/2.75>a?1-(7.5625*(a-=2.25/2.75)*a+.9375):1-(7.5625*(a-=2.625/2.75)*a+.984375)}),i=c("BounceInOut",function(a){var b=.5>a,a=b?1-2*a:2*a-1,a=1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375;return b?.5*(1-a):.5*a+.5}),j=c("CircOut",function(a){return Math.sqrt(1-(a-=1)*a)}),k=c("CircIn",function(a){return-(Math.sqrt(1-a*a)-1)}),l=c("CircInOut",function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}),m=2*Math.PI,n=function(c,d,e){var f=b("easing."+c,function(a,b){this._p1=a||1,this._p2=b||e,this._p3=this._p2/m*(Math.asin(1/this._p1)||0)},!0),c=f.prototype=new a;return c.constructor=f,c.getRatio=d,c.config=function(a,b){return new f(a,b)},f},o=n("ElasticOut",function(a){return this._p1*Math.pow(2,-10*a)*Math.sin((a-this._p3)*m/this._p2)+1},.3),p=n("ElasticIn",function(a){return-(this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*m/this._p2))},.3),n=n("ElasticInOut",function(a){return 1>(a*=2)?-.5*this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*m/this._p2):.5*this._p1*Math.pow(2,-10*(a-=1))*Math.sin((a-this._p3)*m/this._p2)+1},.45),q=c("ExpoOut",function(a){return 1-Math.pow(2,-10*a)}),r=c("ExpoIn",function(a){return Math.pow(2,10*(a-1))-.001}),s=c("ExpoInOut",function(a){return 1>(a*=2)?.5*Math.pow(2,10*(a-1)):.5*(2-Math.pow(2,-10*(a-1)))}),t=Math.PI/2,u=c("SineOut",function(a){return Math.sin(a*t)}),v=c("SineIn",function(a){return-Math.cos(a*t)+1}),c=c("SineInOut",function(a){return-.5*(Math.cos(Math.PI*a)-1)}),w=b("easing.SlowMo",function(a,b,c){null==a?a=.7:a>1&&(a=1),this._p=1!=a?b||0===b?b:.7:0,this._p1=(1-a)/2,this._p2=a,this._p3=this._p1+this._p2,this._calcEnd=!0===c},!0),x=w.prototype=new a;x.constructor=w,x.getRatio=function(a){var b=a+(.5-a)*this._p;return a<this._p1?this._calcEnd?1-(a=1-a/this._p1)*a:b-(a=1-a/this._p1)*a*a*a*b:a>this._p3?this._calcEnd?1-(a=(a-this._p3)/this._p1)*a:b+(a-b)*(a=(a-this._p3)/this._p1)*a*a*a:this._calcEnd?1:b},w.ease=new w(.7,.7),x.config=w.config=function(a,b,c){return new w(a,b,c)};var y=b("easing.SteppedEase",function(a){a=a||1,this._p1=1/a,this._p2=a+1},!0),x=y.prototype=new a;return x.constructor=y,x.getRatio=function(a){return 0>a?a=0:a>=1&&(a=.999999999),(this._p2*a>>0)*this._p1},x.config=y.config=function(a){return new y(a)},b("easing.Bounce",{easeOut:new g,easeIn:new h,easeInOut:new i},!0),b("easing.Circ",{easeOut:new j,easeIn:new k,easeInOut:new l},!0),b("easing.Elastic",{easeOut:new o,easeIn:new p,easeInOut:new n},!0),b("easing.Expo",{easeOut:new q,easeIn:new r,easeInOut:new s},!0),b("easing.Sine",{easeOut:new u,easeIn:new v,easeInOut:new c},!0),{easeOut:new e,easeIn:new f,easeInOut:new d}},!0)}),window._gsDefine&&_gsQueue.pop()()}),ig.baked=!0,ig.module("plugins.tween-lite").requires("plugins.ease-pack").defines(function(){!function(a){var b,c,d,e,f,g=function(b){b=b.split(".");var c,d=a;for(c=0;c<b.length;c++)d[b[c]]=d=d[b[c]]||{};return d},h=g("com.greensock"),i={},j=function(b,c,d,e){this.sc=i[b]?i[b].sc:[],i[b]=this,this.gsClass=null,this.def=d;var f=c||[],h=[];this.check=function(c){for(var k,l=f.length,m=0;-1<--l;)(k=i[f[l]]||new j(f[l])).gsClass?h[l]=k.gsClass:(m++,c&&k.sc.push(this));if(0===m&&d){c=("com.greensock."+b).split(".");var l=c.pop(),n=g(c.join("."))[l]=this.gsClass=d.apply(d,h);for(e&&((a.GreenSockGlobals||a)[l]=n,"function"==typeof define&&define.amd?define((a.GreenSockAMDPath?a.GreenSockAMDPath+"/":"")+b.split(".").join("/"),[],function(){return n}):"undefined"!=typeof module&&module.exports&&(module.exports=n)),l=0;l<this.sc.length;l++)this.sc[l].check(!1)}},this.check(!0)},k=h._class=function(a,b,c){return b=b||function(){},new j(a,[],function(){return b},c),b};a._gsDefine=function(a,b,c,d){return new j(a,b,c,d)};var l=[0,0,1,1],m=[],n=k("easing.Ease",function(a,b,c,d){this._func=a,this._type=c||0,this._power=d||0,this._params=b?l.concat(b):l},!0);for(d=n.prototype,d._calcEnd=!1,d.getRatio=function(a){if(this._func)return this._params[0]=a,this._func.apply(null,this._params);var b=this._type,c=this._power,d=1===b?1-a:2===b?a:.5>a?2*a:2*(1-a);return 1===c?d*=d:2===c?d*=d*d:3===c?d*=d*d*d:4===c&&(d*=d*d*d*d),1===b?1-d:2===b?d:.5>a?d/2:1-d/2},b=["Linear","Quad","Cubic","Quart","Quint"],c=b.length;-1<--c;)d=k("easing."+b[c],null,!0),e=k("easing.Power"+c,null,!0),d.easeOut=e.easeOut=new n(null,null,1,c),d.easeIn=e.easeIn=new n(null,null,2,c),d.easeInOut=e.easeInOut=new n(null,null,3,c);k("easing.Strong",h.easing.Power4,!0),h.easing.Linear.easeNone=h.easing.Linear.easeIn;var o=k("events.EventDispatcher",function(a){this._listeners={},this._eventTarget=a||this});d=o.prototype,d.addEventListener=function(a,b,c,d,e){e=e||0;var f,g=this._listeners[a],h=0;for(null==g&&(this._listeners[a]=g=[]),f=g.length;-1<--f;)a=g[f],a.c===b?g.splice(f,1):0===h&&a.pr<e&&(h=f+1);g.splice(h,0,{c:b,s:c,up:d,pr:e})},d.removeEventListener=function(a,b){var c,d=this._listeners[a];if(d)for(c=d.length;-1<--c;)if(d[c].c===b){d.splice(c,1);break}},d.dispatchEvent=function(a){var b=this._listeners[a];if(b)for(var c,d=b.length,e=this._eventTarget;-1<--d;)c=b[d],c.up?c.c.call(c.s||e,{type:a,target:e}):c.c.call(c.s||e)};var p=a.requestAnimationFrame,q=a.cancelAnimationFrame,r=Date.now||function(){return(new Date).getTime()};for(b=["ms","moz","webkit","o"],c=b.length;-1<--c&&!p;)p=a[b[c]+"RequestAnimationFrame"],q=a[b[c]+"CancelAnimationFrame"]||a[b[c]+"CancelRequestAnimationFrame"];k("Ticker",function(b,c){var d,e,f,g,h,i=this,j=r(),k=!1!==c&&p,l=function(){null!=f&&(k&&q?q(f):a.clearTimeout(f),f=null)},m=function(a){i.time=(r()-j)/1e3,(!d||i.time>=h||!0===a)&&(i.frame++,h=i.time>h?i.time+g-(i.time-h):i.time+g-.001,h<i.time+.001&&(h=i.time+.001),i.dispatchEvent("tick")),!0!==a&&(f=e(m))};o.call(i),this.time=this.frame=0,this.tick=function(){m(!0)},this.fps=function(b){return arguments.length?(d=b,g=1/(d||60),h=this.time+g,e=0===d?function(){}:k&&p?p:function(b){return a.setTimeout(b,1e3*(h-i.time)+1>>0||1)},l(),f=e(m),void 0):d},this.useRAF=function(a){return arguments.length?(l(),k=a,i.fps(d),void 0):k},i.fps(b),a.setTimeout(function(){k&&!f&&i.useRAF(!1)},1e3)}),d=h.Ticker.prototype=new h.events.EventDispatcher,d.constructor=h.Ticker;var s=k("core.Animation",function(a,b){if(this.vars=b||{},this._duration=this._totalDuration=a||0,this._delay=Number(this.vars.delay)||0,this._timeScale=1,this._active=!0===this.vars.immediateRender,this.data=this.vars.data,this._reversed=!0===this.vars.reversed,B){f||(t.tick(),f=!0);var c=this.vars.useFrames?A:B;c.insert(this,c._time),this.vars.paused&&this.paused(!0)}}),t=s.ticker=new h.Ticker;d=s.prototype,d._dirty=d._gc=d._initted=d._paused=!1,d._totalTime=d._time=0,d._rawPrevTime=-1,d._next=d._last=d._onUpdate=d._timeline=d.timeline=null,d._paused=!1,d.play=function(a,b){return arguments.length&&this.seek(a,b),this.reversed(!1),this.paused(!1)},d.pause=function(a,b){return arguments.length&&this.seek(a,b),this.paused(!0)},d.resume=function(a,b){return arguments.length&&this.seek(a,b),this.paused(!1)},d.seek=function(a,b){return this.totalTime(Number(a),!1!==b)},d.restart=function(a,b){return this.reversed(!1),this.paused(!1),this.totalTime(a?-this._delay:0,!1!==b)},d.reverse=function(a,b){return arguments.length&&this.seek(a||this.totalDuration(),b),this.reversed(!0),this.paused(!1)},d.render=function(){},d.invalidate=function(){return this},d._enabled=function(a,b){return this._gc=!a,this._active=a&&!this._paused&&0<this._totalTime&&this._totalTime<this._totalDuration,!0!==b&&(a&&null==this.timeline?this._timeline.insert(this,this._startTime-this._delay):!a&&null!=this.timeline&&this._timeline._remove(this,!0)),!1},d._kill=function(){return this._enabled(!1,!1)},d.kill=function(a,b){return this._kill(a,b),this},d._uncache=function(a){for(a=a?this:this.timeline;a;)a._dirty=!0,a=a.timeline;return this},d.eventCallback=function(a,b,c,d){if(null==a)return null;if("on"===a.substr(0,2)){if(1===arguments.length)return this.vars[a];if(null==b)delete this.vars[a];else if(this.vars[a]=b,this.vars[a+"Params"]=c,this.vars[a+"Scope"]=d,c)for(var e=c.length;-1<--e;)"{self}"===c[e]&&(c=this.vars[a+"Params"]=c.concat(),c[e]=this);"onUpdate"===a&&(this._onUpdate=b)}return this},d.delay=function(a){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+a-this._delay),this._delay=a,this):this._delay},d.duration=function(a){return arguments.length?(this._duration=this._totalDuration=a,this._uncache(!0),this._timeline.smoothChildTiming&&0<this._time&&this._time<this._duration&&0!==a&&this.totalTime(this._totalTime*(a/this._duration),!0),this):(this._dirty=!1,this._duration)},d.totalDuration=function(a){return this._dirty=!1,arguments.length?this.duration(a):this._totalDuration},d.time=function(a,b){return arguments.length?(this._dirty&&this.totalDuration(),a>this._duration&&(a=this._duration),this.totalTime(a,b)):this._time},d.totalTime=function(a,b){if(!arguments.length)return this._totalTime;if(this._timeline){if(0>a&&(a+=this.totalDuration()),this._timeline.smoothChildTiming&&(this._dirty&&this.totalDuration(),a>this._totalDuration&&(a=this._totalDuration),this._startTime=(this._paused?this._pauseTime:this._timeline._time)-(this._reversed?this._totalDuration-a:a)/this._timeScale,this._timeline._dirty||this._uncache(!1),!this._timeline._active))for(var c=this._timeline;c._timeline;)c.totalTime(c._totalTime,!0),c=c._timeline;this._gc&&this._enabled(!0,!1),this._totalTime!==a&&this.render(a,b,!1)}return this},d.startTime=function(a){return arguments.length?(a!==this._startTime&&(this._startTime=a,this.timeline&&this.timeline._sortChildren&&this.timeline.insert(this,a-this._delay)),this):this._startTime},d.timeScale=function(a){if(!arguments.length)return this._timeScale;if(a=a||1e-6,this._timeline&&this._timeline.smoothChildTiming){var b=this._pauseTime||0===this._pauseTime?this._pauseTime:this._timeline._totalTime;this._startTime=b-(b-this._startTime)*this._timeScale/a}return this._timeScale=a,this._uncache(!1)},d.reversed=function(a){return arguments.length?(a!=this._reversed&&(this._reversed=a,this.totalTime(this._totalTime,!0)),this):this._reversed},d.paused=function(a){return arguments.length?(a!=this._paused&&this._timeline&&(!a&&this._timeline.smoothChildTiming&&(this._startTime+=this._timeline.rawTime()-this._pauseTime,this._uncache(!1)),this._pauseTime=a?this._timeline.rawTime():null,this._paused=a,this._active=!this._paused&&0<this._totalTime&&this._totalTime<this._totalDuration),this._gc&&(a||this._enabled(!0,!1)),this):this._paused},h=k("core.SimpleTimeline",function(a){s.call(this,0,a),this.autoRemoveChildren=this.smoothChildTiming=!0}),d=h.prototype=new s,d.constructor=h,d.kill()._gc=!1,d._first=d._last=null,d._sortChildren=!1,d.insert=function(a,b){a._startTime=Number(b||0)+a._delay,a._paused&&this!==a._timeline&&(a._pauseTime=a._startTime+(this.rawTime()-a._startTime)/a._timeScale),a.timeline&&a.timeline._remove(a,!0),a.timeline=a._timeline=this,a._gc&&a._enabled(!0,!0);var c=this._last;if(this._sortChildren)for(var d=a._startTime;c&&c._startTime>d;)c=c._prev;return c?(a._next=c._next,c._next=a):(a._next=this._first,this._first=a),a._next?a._next._prev=a:this._last=a,a._prev=c,this._timeline&&this._uncache(!0),this},d._remove=function(a,b){return a.timeline===this&&(b||a._enabled(!1,!0),a.timeline=null,a._prev?a._prev._next=a._next:this._first===a&&(this._first=a._next),a._next?a._next._prev=a._prev:this._last===a&&(this._last=a._prev),this._timeline&&this._uncache(!0)),this},d.render=function(a,b){var c,d=this._first;for(this._totalTime=this._time=this._rawPrevTime=a;d;)c=d._next,(d._active||a>=d._startTime&&!d._paused)&&(d._reversed?d.render((d._dirty?d.totalDuration():d._totalDuration)-(a-d._startTime)*d._timeScale,b,!1):d.render((a-d._startTime)*d._timeScale,b,!1)),d=c},d.rawTime=function(){return this._totalTime};var u=k("TweenLite",function(a,b,c){if(s.call(this,b,c),null==a)throw"Cannot tween an undefined reference.";if(this.target=a,this._overwrite=null==this.vars.overwrite?z[u.defaultOverwrite]:"number"==typeof this.vars.overwrite?this.vars.overwrite>>0:z[this.vars.overwrite],(a instanceof Array||a.jquery)&&"object"==typeof a[0])for(this._targets=a.slice(0),this._propLookup=[],this._siblings=[],a=0;a<this._targets.length;a++)c=this._targets[a],c.jquery?(this._targets.splice(a--,1),this._targets=this._targets.concat(c.constructor.makeArray(c))):(this._siblings[a]=C(c,this,!1),1===this._overwrite&&1<this._siblings[a].length&&D(c,this,null,1,this._siblings[a]));else this._propLookup={},this._siblings=C(a,this,!1),1===this._overwrite&&1<this._siblings.length&&D(a,this,null,1,this._siblings);(this.vars.immediateRender||0===b&&0===this._delay&&!1!==this.vars.immediateRender)&&this.render(-this._delay,!1,!0)},!0);d=u.prototype=new s,d.constructor=u,d.kill()._gc=!1,d.ratio=0,d._firstPT=d._targets=d._overwrittenProps=null,d._notifyPluginsOfEnabled=!1,u.version=1.668,u.defaultEase=d._ease=new n(null,null,1,1),u.defaultOverwrite="auto",u.ticker=t;var v=u._plugins={},w=u._tweenLookup={},x=0,y={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,orientToBezier:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1},z={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},A=s._rootFramesTimeline=new h,B=s._rootTimeline=new h;B._startTime=t.time,A._startTime=t.frame,B._active=A._active=!0,s._updateRoot=function(){if(B.render((t.time-B._startTime)*B._timeScale,!1,!1),A.render((t.frame-A._startTime)*A._timeScale,!1,!1),!(t.frame%120)){var a,b,c;for(c in w){for(b=w[c].tweens,a=b.length;-1<--a;)b[a]._gc&&b.splice(a,1);0===b.length&&delete w[c]}}},t.addEventListener("tick",s._updateRoot);var C=function(a,b,c){var d,e=a._gsTweenID;if(w[e||(a._gsTweenID=e="t"+x++)]||(w[e]={target:a,tweens:[]}),b&&(a=w[e].tweens,a[d=a.length]=b,c))for(;-1<--d;)a[d]===b&&a.splice(d,1);return w[e].tweens},D=function(a,b,c,d,e){var f,g,h;if(1===d||d>=4){for(a=e.length,f=0;a>f;f++)if((h=e[f])!==b)h._gc||h._enabled(!1,!1)&&(g=!0);else if(5===d)break;return g}var i,j=b._startTime+1e-10,k=[],l=0,m=0===b._duration;for(f=e.length;-1<--f;)(h=e[f])===b||h._gc||h._paused||(h._timeline!==b._timeline?(i=i||E(b,0,m),0===E(h,i,m)&&(k[l++]=h)):h._startTime<=j&&h._startTime+h.totalDuration()/h._timeScale+1e-10>j&&((m||!h._initted)&&2e-10>=j-h._startTime||(k[l++]=h)));for(f=l;-1<--f;)h=k[f],2===d&&h._kill(c,a)&&(g=!0),(2!==d||!h._firstPT&&h._initted)&&h._enabled(!1,!1)&&(g=!0);return g},E=function(a,b,c){for(var d=a._timeline,e=d._timeScale,f=a._startTime;d._timeline;){if(f+=d._startTime,e*=d._timeScale,d._paused)return-100;d=d._timeline}return f/=e,f>b?f-b:c&&f===b||!a._initted&&2e-10>f-b?1e-10:(f+=a.totalDuration()/a._timeScale/e)>b?0:f-b-1e-10};d._init=function(){this.vars.startAt&&(this.vars.startAt.overwrite=0,this.vars.startAt.immediateRender=!0,u.to(this.target,0,this.vars.startAt));var a,b;if(this._ease=this.vars.ease instanceof n?this.vars.easeParams instanceof Array?this.vars.ease.config.apply(this.vars.ease,this.vars.easeParams):this.vars.ease:"function"==typeof this.vars.ease?new n(this.vars.ease,this.vars.easeParams):u.defaultEase,this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(a=this._targets.length;-1<--a;)this._initProps(this._targets[a],this._propLookup[a]={},this._siblings[a],this._overwrittenProps?this._overwrittenProps[a]:null)&&(b=!0);else b=this._initProps(this.target,this._propLookup,this._siblings,this._overwrittenProps);if(b&&u._onPluginEvent("_onInitAllProps",this),this._overwrittenProps&&null==this._firstPT&&"function"!=typeof this.target&&this._enabled(!1,!1),this.vars.runBackwards)for(a=this._firstPT;a;)a.s+=a.c,a.c=-a.c,a=a._next;this._onUpdate=this.vars.onUpdate,this._initted=!0},d._initProps=function(a,b,c,d){var e,f,g,h,i,j;if(null==a)return!1;for(e in this.vars){if(y[e]){if(("onStartParams"===e||"onUpdateParams"===e||"onCompleteParams"===e||"onReverseCompleteParams"===e||"onRepeatParams"===e)&&(i=this.vars[e]))for(f=i.length;-1<--f;)"{self}"===i[f]&&(i=this.vars[e]=i.concat(),i[f]=this)}else if(v[e]&&(h=new v[e])._onInitTween(a,this.vars[e],this)){for(this._firstPT=j={_next:this._firstPT,t:h,p:"setRatio",s:0,c:1,f:!0,n:e,pg:!0,pr:h._priority},f=h._overwriteProps.length;-1<--f;)b[h._overwriteProps[f]]=this._firstPT;(h._priority||h._onInitAllProps)&&(g=!0),(h._onDisable||h._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=b[e]=j={_next:this._firstPT,t:a,p:e,f:"function"==typeof a[e],n:e,pg:!1,pr:0},j.s=j.f?a[e.indexOf("set")||"function"!=typeof a["get"+e.substr(3)]?e:"get"+e.substr(3)]():parseFloat(a[e]),f=this.vars[e],j.c="number"==typeof f?f-j.s:"string"==typeof f&&"="===f.charAt(1)?parseInt(f.charAt(0)+"1",10)*Number(f.substr(2)):Number(f)||0;j&&j._next&&(j._next._prev=j)}return d&&this._kill(d,a)?this._initProps(a,b,c,d):1<this._overwrite&&this._firstPT&&1<c.length&&D(a,this,b,this._overwrite,c)?(this._kill(b,a),this._initProps(a,b,c,d)):g},d.render=function(a,b,c){var d,e,f=this._time;if(a>=this._duration)this._totalTime=this._time=this._duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(d=!0,e="onComplete"),0===this._duration&&((0===a||0>this._rawPrevTime)&&this._rawPrevTime!==a&&(c=!0),this._rawPrevTime=a);else if(0>=a)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==f||0===this._duration&&0<this._rawPrevTime)&&(e="onReverseComplete",d=this._reversed),0>a?(this._active=!1,0===this._duration&&(0<=this._rawPrevTime&&(c=!0),this._rawPrevTime=a)):this._initted||(c=!0);else if(this._totalTime=this._time=a,this._easeType){var g=a/this._duration,h=this._easeType,i=this._easePower;(1===h||3===h&&g>=.5)&&(g=1-g),3===h&&(g*=2),1===i?g*=g:2===i?g*=g*g:3===i?g*=g*g*g:4===i&&(g*=g*g*g*g),this.ratio=1===h?1-g:2===h?g:.5>a/this._duration?g/2:1-g/2}else this.ratio=this._ease.getRatio(a/this._duration);if(this._time!==f||c){for(this._initted||(this._init(),!d&&this._time&&(this.ratio=this._ease.getRatio(this._time/this._duration))),!this._active&&!this._paused&&(this._active=!0),0!==f||!this.vars.onStart||0===this._time&&0!==this._duration||b||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||m),a=this._firstPT;a;)a.f?a.t[a.p](a.c*this.ratio+a.s):a.t[a.p]=a.c*this.ratio+a.s,a=a._next;this._onUpdate&&(b||this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||m)),e&&!this._gc&&(d&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),b||this.vars[e]&&this.vars[e].apply(this.vars[e+"Scope"]||this,this.vars[e+"Params"]||m))}},d._kill=function(a,b){if("all"===a&&(a=null),null==a&&(null==b||b===this.target))return this._enabled(!1,!1);b=b||this._targets||this.target;var c,d,e,f,g,h,i;if((b instanceof Array||b.jquery)&&"object"==typeof b[0])for(c=b.length;-1<--c;)this._kill(a,b[c])&&(g=!0);else{if(this._targets){for(c=this._targets.length;-1<--c;)if(b===this._targets[c]){f=this._propLookup[c]||{},this._overwrittenProps=this._overwrittenProps||[],d=this._overwrittenProps[c]=a?this._overwrittenProps[c]||{}:"all";break}}else{if(b!==this.target)return!1;f=this._propLookup,d=this._overwrittenProps=a?this._overwrittenProps||{}:"all"}if(f)for(e in h=a||f,i=a!==d&&"all"!==d&&a!==f&&(null==a||!0!==a._tempKill),h)(c=f[e])&&(c.pg&&c.t._kill(h)&&(g=!0),c.pg&&0!==c.t._overwriteProps.length||(c._prev?c._prev._next=c._next:c===this._firstPT&&(this._firstPT=c._next),c._next&&(c._next._prev=c._prev),c._next=c._prev=null),delete f[e]),i&&(d[e]=1)}return g},d.invalidate=function(){return this._notifyPluginsOfEnabled&&u._onPluginEvent("_onDisable",this),this._onUpdate=this._overwrittenProps=this._firstPT=null,this._initted=this._active=this._notifyPluginsOfEnabled=!1,this._propLookup=this._targets?{}:[],this},d._enabled=function(a,b){if(a&&this._gc)if(this._targets)for(var c=this._targets.length;-1<--c;)this._siblings[c]=C(this._targets[c],this,!0);else this._siblings=C(this.target,this,!0);return s.prototype._enabled.call(this,a,b),this._notifyPluginsOfEnabled&&this._firstPT?u._onPluginEvent(a?"_onEnable":"_onDisable",this):!1},u.to=function(a,b,c){return new u(a,b,c)},u.from=function(a,b,c){return c.runBackwards=!0,!1!==c.immediateRender&&(c.immediateRender=!0),new u(a,b,c)},u.fromTo=function(a,b,c,d){return d.startAt=c,c.immediateRender&&(d.immediateRender=!0),new u(a,b,d)},u.delayedCall=function(a,b,c,d,e){return new u(b,0,{delay:a,onComplete:b,onCompleteParams:c,onCompleteScope:d,onReverseComplete:b,onReverseCompleteParams:c,onReverseCompleteScope:d,immediateRender:!1,useFrames:e,overwrite:0})},u.set=function(a,b){return new u(a,0,b)},u.killTweensOf=u.killDelayedCallsTo=function(a,b){for(var c=u.getTweensOf(a),d=c.length;-1<--d;)c[d]._kill(b,a)},u.getTweensOf=function(a){if(null!=a){var b,c,d;if((a instanceof Array||a.jquery)&&"object"==typeof a[0]){for(b=a.length,c=[];-1<--b;)c=c.concat(u.getTweensOf(a[b]));for(b=c.length;-1<--b;)for(d=c[b],a=b;-1<--a;)d===c[a]&&c.splice(b,1)}else for(c=C(a).concat(),b=c.length;-1<--b;)c[b]._gc&&c.splice(b,1);return c}};var F=k("plugins.TweenPlugin",function(a,b){this._overwriteProps=(a||"").split(","),this._propName=this._overwriteProps[0],this._priority=b||0},!0);if(d=F.prototype,F.version=12,F.API=2,d._firstPT=null,d._addTween=function(a,b,c,d,e,f){var g;null!=d&&(g="number"==typeof d||"="!==d.charAt(1)?Number(d)-c:parseInt(d.charAt(0)+"1",10)*Number(d.substr(2)))&&(this._firstPT=a={_next:this._firstPT,t:a,p:b,s:c,c:g,f:"function"==typeof a[b],n:e||b,r:f},a._next&&(a._next._prev=a))},d.setRatio=function(a){for(var b,c=this._firstPT;c;)b=c.c*a+c.s,c.r&&(b=b+(b>0?.5:-.5)>>0),c.f?c.t[c.p](b):c.t[c.p]=b,c=c._next},d._kill=function(a){if(null!=a[this._propName])this._overwriteProps=[];else for(var b=this._overwriteProps.length;-1<--b;)null!=a[this._overwriteProps[b]]&&this._overwriteProps.splice(b,1);for(b=this._firstPT;b;)null!=a[b.n]&&(b._next&&(b._next._prev=b._prev),b._prev?(b._prev._next=b._next,b._prev=null):this._firstPT===b&&(this._firstPT=b._next)),b=b._next;return!1},d._roundProps=function(a,b){for(var c=this._firstPT;c;)(a[this._propName]||null!=c.n&&a[c.n.split(this._propName+"_").join("")])&&(c.r=b),c=c._next},u._onPluginEvent=function(a,b){var c,d=b._firstPT;if("_onInitAllProps"===a){for(var e,f,g,h;d;){for(h=d._next,e=f;e&&e.pr>d.pr;)e=e._next;(d._prev=e?e._prev:g)?d._prev._next=d:f=d,(d._next=e)?e._prev=d:g=d,d=h}d=b._firstPT=f}for(;d;)d.pg&&"function"==typeof d.t[a]&&d.t[a]()&&(c=!0),d=d._next;return c},F.activate=function(a){for(var b=a.length;-1<--b;)a[b].API===F.API&&(u._plugins[(new a[b])._propName]=a[b]);return!0},b=a._gsQueue){for(c=0;c<b.length;c++)b[c]();for(d in i)i[d].def||console.log("Warning: TweenLite encountered missing dependency: com.greensock."+d)}}(window)}),ig.baked=!0,ig.module("game.packed-textures").requires("bootstrap.plugins.texture-atlas").defines(function(){ig.PackedTextures=ig.Class.extend({textureAtlas:null,entityJSON:null,screenJSON:null,staticInstantiate:function(){return null==ig.PackedTextures.instance?null:ig.PackedTextures.instance},init:function(){ig.PackedTextures.instance=this,ig.entitiesTextureAtlas=new ig.TextureAtlas("media/textures/entities.png",{frames:[{filename:"blood-puddle.png",rotated:!1,trimmed:!0,frame:{x:0,y:411,w:46,h:16},spriteSourceSize:{x:0,y:0,w:46,h:16},sourceSize:{w:46,h:16}},{filename:"goat.png",rotated:!1,trimmed:!0,frame:{x:0,y:429,w:42,h:47},spriteSourceSize:{x:0,y:0,w:42,h:47},sourceSize:{w:42,h:47}},{filename:"knight.png",rotated:!1,trimmed:!0,frame:{x:0,y:478,w:24,h:60},spriteSourceSize:{x:0,y:0,w:24,h:60},sourceSize:{w:24,h:60}},{filename:"player-0.png",rotated:!1,trimmed:!0,frame:{x:162,y:169,w:160,h:240},spriteSourceSize:{x:0,y:0,w:160,h:240},sourceSize:{w:160,h:240}},{filename:"player-1.png",rotated:!1,trimmed:!0,frame:{x:324,y:0,w:160,h:240},spriteSourceSize:{x:0,y:0,w:160,h:240},sourceSize:{w:160,h:240}},{filename:"player-2.png",rotated:!1,trimmed:!0,frame:{x:0,y:169,w:160,h:240},spriteSourceSize:{x:0,y:0,w:160,h:240},sourceSize:{w:160,h:240}},{filename:"player-corpse.png",rotated:!1,trimmed:!0,frame:{x:0,y:0,w:251,h:167},spriteSourceSize:{x:0,y:0,w:251,h:167},sourceSize:{w:251,h:167}},{filename:"player-ghost.png",rotated:!1,trimmed:!0,frame:{x:324,y:242,w:160,h:275},spriteSourceSize:{x:0,y:0,w:160,h:275},sourceSize:{w:160,h:275}},{filename:"touch-arrow-left.png",rotated:!1,trimmed:!0,frame:{x:547,y:0,w:59,h:316},spriteSourceSize:{x:0,y:0,w:60,h:316},sourceSize:{w:60,h:316}},{filename:"touch-arrow-right.png",rotated:!1,trimmed:!0,frame:{x:486,y:0,w:59,h:316},spriteSourceSize:{x:1,y:0,w:60,h:316},sourceSize:{w:60,h:316}},{emptyObject:"keeps this template from breaking"}],meta:{app:"ShoeBox",size:{w:608,h:540}}}),ig.screensTextureAtlas=new ig.TextureAtlas("media/textures/screens.png",{frames:[{filename:"background-image.png",rotated:!1,trimmed:!0,frame:{x:0,y:602,w:679,h:466},spriteSourceSize:{x:0,y:0,w:679,h:466},sourceSize:{w:679,h:466}},{filename:"background-mask.png",rotated:!1,trimmed:!0,frame:{x:0,y:0,w:755,h:600},spriteSourceSize:{x:0,y:0,w:755,h:600},sourceSize:{w:755,h:600}},{filename:"start-text.png",rotated:!1,trimmed:!0,frame:{x:0,y:1070,w:272,h:14},spriteSourceSize:{x:0,y:0,w:272,h:14},sourceSize:{w:272,h:14}},{filename:"title.png",rotated:!1,trimmed:!0,frame:{x:681,y:602,w:499,h:134},spriteSourceSize:{x:0,y:0,w:499,h:134},sourceSize:{w:499,h:134}},{emptyObject:"keeps this template from breaking"}],meta:{app:"ShoeBox",size:{w:1182,h:1086}}})}}),ig.textureData=new ig.PackedTextures}),ig.baked=!0,ig.module("bootstrap.plugins.camera").requires("impact.game","impact.image").defines(function(){ig.Game.inject({cameraFollow:null,lightOffset:{x:0,y:0},quakeTimer:new ig.Timer,duration:1,loadLevel:function(a){this.parent(a),this.mainMap=ig.game.getMapByName("main");var b=this.mainMap.tilesize;this.screenBoundary={min:{x:0,y:.5*-b},max:{x:this.mainMap.width*b-ig.system.width,y:this.mainMap.height*b-b-ig.system.height}},this.mainMap.width*this.mainMap.tilesize<ig.system.width&&(this.screenBoundary.min.x=.5*-(ig.system.width-this.mainMap.width*this.mainMap.tilesize),this.screenBoundary.max.x=this.screenBoundary.min.x),this.mainMap.height*this.mainMap.tilesize<ig.system.height&&(this.screenBoundary.min.y=.5*-(ig.system.height-this.mainMap.height*this.mainMap.tilesize),this.screenBoundary.max.y=this.screenBoundary.min.y)},update:function(){if(this.parent(),this.cameraFollow&&(this.screen.x=this.cameraFollow.pos.x-.5*ig.system.width+.5*this.cameraFollow.size.x,this.screen.y=this.cameraFollow.pos.y-.5*ig.system.height-this.screenBoundary.min.y+this.cameraYOffset-100,this.screen.x<this.screenBoundary.min.x?this.screen.x=this.screenBoundary.min.x:this.screen.x>this.screenBoundary.max.x&&(this.screen.x=this.screenBoundary.max.x),this.screen.y<0&&(this.screen.y=0)),!this.paused){var a=this.quakeTimer.delta();if(-.1>a){this.quakeRunning=!0;var b=this.strength*Math.pow(-a/this.duration,2);b>.5&&(ig.game.screen.x+=Math.random().map(0,1,-b,b),ig.game.screen.y+=Math.random().map(0,1,-b,b))}else this.quakeRunning=!1}},shake:function(a,b,c){this.duration=a?a:1,this.strength=b?b:3,(c||!this.quakeRunning)&&this.quakeTimer.set(this.duration)}})}),ig.baked=!0,ig.module("game.plugins.effects").requires("impact.game","impact.image","bootstrap.plugins.camera").defines(function(){ig.Game.inject({scanLines:new ig.Image("media/sprites/scan-lines.png"),lightMask:new ig.Image("media/sprites/lighting-effect.png"),lightOffset:{x:0,y:0},meterWidth:193,meterHeight:29,meterPadding:5,meterIconSize:{x:32,y:29},padding:10,update:function(){this.parent(),this.cameraFollow&&this.lightMask&&(this.lightOffset.x=.5*(this.screen.x-this.lightMask.width),this.lightOffset.y=.5*(this.screen.y-this.lightMask.height))},draw:function(){this.parent(),this.cameraFollow&&this.lightMask&&this.lightMask.draw(0,0),this.scanLines&&this.scanLines.draw(0,0)},drawMeterBar:function(a,b,c,d){b>1&&(b=1),ig.entitiesTextureAtlas.drawFrame("meter-"+a+".png",c,d,!1,b*(this.meterWidth+this.meterIconSize.x),this.meterHeight)}})}),ig.baked=!0,ig.module("game.entities.void").requires("impact.entity").defines(function(){EntityVoid=ig.Entity.extend({_wmDrawBox:!0,_wmBoxColor:"rgba(128, 28, 230, 0.7)",_wmScalable:!0,size:{x:80,y:80},update:function(){}})}),ig.baked=!0,ig.module("bootstrap.entities.spawner","bootstrap.plugins.pause").requires("impact.entity").defines(function(){EntitySpawner=ig.Entity.extend({idleTimer:null,_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",_wmScalable:!0,size:{x:80,y:80},delay:3,delayTime:0,gravityFactor:0,target:null,targets:[],entities:[],emptyCallback:null,level:-1,activated:!1,totalSpawns:1,init:function(a,b,c){this.parent(a,b,c),this.targets=ig.ksort(this.target),c.entities&&(this.entities=c.entities.split(","))},update:function(){this.activated&&!ig.game.paused&&(this.delayTime+=this.idleTimer.tick(),this.delayTime>this.delay&&(this.idleTimer.reset(),this.delayTime=0,this.spawnNewEntity()))},activate:function(){this.activated=!0,this.idleTimer=new ig.Timer},spawnNewEntity:function(a,b){if(!(this.entities.length<=0)){a||(a={spawner:this});for(var c=0;c<this.totalSpawns;c++)if(this.targets.length>0){var d=Math.floor(Math.random()*this.targets.length),e=ig.game.getEntityByName("undefined"==typeof b?this.targets[d]:b);a.flip=e.flip;var f=Math.round(Math.random()*(e.size.x/10)),g=10*f+e.pos.x,h=Math.round(Math.random()*(e.size.y/20)),i=20*h+e.pos.y;a.zIndex=h,this.createEntity(g,i,a)}}},createEntity:function(a,b,c){var d=Math.floor(Math.random()*this.entities.length),e=ig.game.spawnEntity(this.entities[d],a,b,c);
return ig.game.sortEntitiesDeferred(),e},draw:function(){},removeItem:function(){this.pool--},pause:function(a){this.idleTimer&&(a?this.idleTimer.pause():this.idleTimer.unpause())}})}),ig.baked=!0,ig.module("game.entities.spawner-bonus").requires("bootstrap.entities.spawner").defines(function(){EntitySpawnerBonus=EntitySpawner.extend({playerEntity:null,spawnLimit:1,baseSpawnLimit:1,activate:function(){this.parent(),this.playerEntity||(this.playerEntity=ig.game.player),this.spawnLimit=this.baseSpawnLimit},spawnNewEntity:function(){this.playerEntity.health<.5*this.playerEntity.maxHealth&&this.spawnLimit>0&&(this.parent(),this.spawnLimit--)}})}),ig.baked=!0,ig.module("game.entities.hero").requires("impact.entity","impact.game").defines(function(){EntityHero=ig.Entity.extend({_wmIgnore:!0,type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.PASSIVE,gravityFactor:0,attackDelay:1,attackTimer:new ig.Timer,attackValue:1,flip:!1,speed:25,health:2,bounciness:.3,bloodEntity:"EntityDeathExplosionSmallParticle",hitSFX:new ig.Sound("media/sounds/hurt2.*"),freeze:!1,init:function(a,b,c){this.parent(a,b,c),this.atlas=ig.entitiesTextureAtlas,this.setupAnimation()},setupAnimation:function(){},update:function(){if(this.parent(),!this.freeze){if(ig.game.gameOver)this.vel.x=this.accel.x=0;else{var a=this.flip?-1:1;this.vel.x+=this.speed*a}var b=3;this.offset.y=Math.random().map(0,b,-b,b)}},handleMovementTrace:function(a){this.parent(a),a.collision.x&&this.kill(!1)},kill:function(){this.parent(),ig.game.totalDeaths++},receiveDamage:function(a,b){this.parent(a,b),this.hitSFX.play(),ig.game.spawnEntity(EntityPointDisplay,this.pos.x,this.pos.y-30,{value:a+1}),this.health<=0&&this.onKilled()},onKilled:function(){ig.game.spawnEntity(EntityBloodPuddle,this.pos.x,this.pos.y+this.size.y-10,{flip:this.flip}),ig.game.kills++},flipDirection:function(){this.flip=!this.flip,this.currentAnim.flip.x=this.flip}}),EntityBloodPuddle=ig.Entity.extend({flip:!1,delay:20,fadetime:20,idleTimer:null,zIndex:-2,splat:new ig.Sound("media/sounds/KilledADude.*"),init:function(a,b,c){this.parent(a,b,c),this.atlas=ig.entitiesTextureAtlas,this.addTextureAtlasAnim(this.atlas,"idle",1,["blood-puddle.png"],!1),this.currentAnim.flip.x=this.flip,this.idleTimer=new ig.Timer,ig.game.sortEntitiesDeferred(),this.splat.play()},update:function(){return this.idleTimer.delta()>this.delay?(this.kill(),void 0):(this.currentAnim.alpha=this.idleTimer.delta().map(this.delay-this.fadetime,this.delay,1,0),void 0)}}),EntityPointDisplay=ig.Entity.extend({animSheet:new ig.AnimationSheet("media/sprites/small-points.png",28,14),idleTimer:null,delay:.5,fadetime:1,zIndex:7,speed:1,gravityFactor:0,init:function(a,b,c){this.parent(a,b,c),this.addAnim("idle",1,[c.value-1]),this.idleTimer=new ig.Timer,ig.game.sortEntitiesDeferred()},update:function(){return this.parent(),this.vel.y-=this.speed,this.idleTimer.delta()>this.delay?(this.kill(),void 0):(this.currentAnim.alpha=this.idleTimer.delta().map(this.delay-this.fadetime,this.delay,1,0),void 0)}})}),ig.baked=!0,ig.module("game.entities.hero-knight").requires("game.entities.hero").defines(function(){EntityHeroKnight=EntityHero.extend({_wmIgnore:!1,size:{x:20,y:60},offset:{x:0,y:0},speed:25,health:2,init:function(a,b,c){this.parent(a,b,c)},setupAnimation:function(){this.addTextureAtlasAnim(this.atlas,"idle",1,["knight.png"],!1),this.currentAnim.flip.x=this.flip},check:function(a){a instanceof EntityPlayer&&(a.flip!=this.flip?(this.receiveDamage(1,a),this.vel.x+=200*(this.flip?-1:1)):this.attackTimer.delta()>this.attackDelay&&(this.attackTimer.reset(),a.receiveDamage(this.attackValue,this),this.vel.x+=400*(this.flip?-1:1)))}})}),ig.baked=!0,ig.module("game.entities.spawner-heros").requires("bootstrap.entities.spawner","game.entities.hero-knight").defines(function(){EntitySpawnerHeros=EntitySpawner.extend({entitiesMasterList:[],baseLevel:5,init:function(a,b,c){this.parent(a,b,c),this.entitiesMasterList=["EntityHeroKnight"]},activate:function(a){this.parent();var b=a/this.baseLevel;b>1&&(b=1);var c=Math.round(b*this.entitiesMasterList.length)+1;this.entities=this.entitiesMasterList.slice(0,c)}})}),ig.baked=!0,ig.module("game.entities.player").requires("impact.entity","game.entities.hero").defines(function(){EntityPlayer=ig.Entity.extend({size:{x:160,y:240},offset:{x:0,y:0},type:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.ACTIVE,speed:10,zIndex:5,gravityFactor:2,friction:{x:400,y:200},speed:400,flip:!1,health:10,maxHealth:10,bounciness:.2,hitSFX:new ig.Sound("media/sounds/hurt1.*"),rageSFX:new ig.Sound("media/sounds/DramaticFallAndCrash.*"),landingSFX:new ig.Sound("media/sounds/LandingSound.*"),blastRadius:350,raging:!1,gotoNextLevel:!1,nextSafeZone:0,init:function(a,b,c){this.parent(a,b,c),this.setupAnimation()},setupAnimation:function(){var a=ig.entitiesTextureAtlas;this.addTextureAtlasAnim(a,"idle",1,["player-2.png"],!1),this.addTextureAtlasAnim(a,"run",.3,["player-1.png","player-0.png","player-1.png","player-2.png"],!1),this.currentAnim.flip.x=this.flip},update:function(){this.parent(),0!=this.vel.x?(this.offset.y=Math.random().map(0,1,0,2),this.currentAnim=this.anims.run,this.currentAnim.flip.x=this.flip):(this.offset.y=0,this.currentAnim=this.anims.idle,this.currentAnim.flip.x=this.flip),1==this.raging&&0==this.vel.y&&(this.killWithinRange(this.blastRadius),this.raging=!1),this.gotoNextLevel&&this.pos.y>this.nextSafeZone&&(this.gotoNextLevel=!1)},killWithinRange:function(a){for(var b,c=ig.game.entities,d=0;d<c.length;d++)if(b=c[d],b.type==ig.Entity.TYPE.B){var e=this.distanceTo(b);a>e&&b.receiveDamage(2,this)}},move:function(a){if(0==this.vel.y){switch(a){case"right":this.vel.x=this.speed,this.flip=!1;break;case"left":this.vel.x=-this.speed,this.flip=!0}this.currentAnim.flip.x=this.flip}},onGotoNextLevel:function(){this.health=this.maxHealth},handleMovementTrace:function(a){this.gotoNextLevel?(this.pos.x+=this.vel.x*ig.system.tick,this.pos.y+=this.vel.y*ig.system.tick):(this.parent(a),a.collision.y&&!this.standing&&(ig.game.shake(2,4),this.landingSFX.play()))},receiveDamage:function(a,b){this.parent(a,b),this.hitSFX.play()},onRage:function(){this.vel.x=this.accel.x=0,this.vel.y=this.accel.y=-200,this.raging=!0,this.rageSFX.play()},kill:function(){this.parent(),this.killWithinRange(150),ig.game.shake(4,8,!1),ig.game.onGameOver(),ig.game.spawnEntity(EntityGhost,this.pos.x,this.pos.y-30,{flip:this.flip,zIndex:this.zIndex,name:"ghost"}),ig.game.spawnEntity(EntityCorpse,this.pos.x-.5*this.size.x,this.pos.y+.3*this.size.y,{flip:this.flip,zIndex:this.zIndex})}}),EntityCorpse=ig.Entity.extend({flip:!1,gravityFactor:0,init:function(a,b,c){this.parent(a,b,c),this.setupAnimation()},setupAnimation:function(){var a=ig.entitiesTextureAtlas;this.addTextureAtlasAnim(a,"idle",1,["player-corpse.png"],!1),this.currentAnim.flip.x=this.flip}}),EntityGhost=ig.Entity.extend({flip:!1,gravityFactor:0,speed:200,maxVel:{x:0,y:300},init:function(a,b,c){this.parent(a,b,c),ig.game.cameraFollow=this,ig.game.cameraYOffset=190,this.setupAnimation()},setupAnimation:function(){var a=ig.entitiesTextureAtlas;this.addTextureAtlasAnim(a,"idle",1,["player-ghost.png"],!1),this.currentAnim.flip.x=this.flip},update:function(){this.parent(),ig.game.gameOverDelayTimer.delta()<ig.game.gameOverDelay&&(this.speed=.2*this.speed),this.accel.y-=this.speed,this.pos.y<-300&&ig.game.exitGame()},handleMovementTrace:function(){this.pos.x+=this.vel.x*ig.system.tick,this.pos.y+=this.vel.y*ig.system.tick}})}),ig.baked=!0,ig.module("game.levels.dungeon-template").requires("impact.image","game.entities.void","game.entities.spawner-bonus","game.entities.spawner-heros","game.entities.player").defines(function(){LevelDungeonTemplate={entities:[{type:"EntityVoid",x:48,y:1100,settings:{size:{x:50,y:80},name:"leftSide",flip:0}},{type:"EntityVoid",x:1176,y:1100,settings:{size:{x:50,y:80},name:"rightSide",flip:1}},{type:"EntitySpawnerBonus",x:696,y:36,settings:{target:{1:"rightSide",2:"leftSide"},entities:"EntityGoat",delay:3.5,name:"spawner-bonus"}},{type:"EntitySpawnerHeros",x:476,y:36,settings:{delay:2.5,target:{1:"leftSide",2:"rightSide"},name:"spawner"}},{type:"EntityPlayer",x:560,y:-280}],layer:[{name:"stars",width:5,height:5,linkWithCollision:!1,visible:1,tilesetName:"/Html/media/sprites/sky-tiles.png",repeat:!0,preRender:!0,distance:"3",tilesize:80,foreground:!1,data:[[13,10,11,12,13],[0,0,10,0,0],[21,22,0,10,13],[0,0,35,13,36],[21,10,12,0,21]]},{name:"middle_ground",width:19,height:16,linkWithCollision:!1,visible:1,tilesetName:"/Html/media/sprites/sky-tiles.png",repeat:!1,preRender:!0,distance:"2",tilesize:80,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3,1,2,1,2,3,4,0,5,6,7,8,4,5,2,6,7,8,0],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14]]},{name:"main",width:16,height:17,linkWithCollision:!1,visible:1,tilesetName:"/Html/media/sprites/sky-tiles.png",repeat:!1,preRender:!0,distance:"1",tilesize:80,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[26,15,16,17,18,19,20,27,20,27,28,29,30,31,32,26],[26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26],[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],[33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33]]},{name:"collision",width:32,height:34,linkWithCollision:!1,visible:0,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:40,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[34,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,45],[34,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,45],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}]},LevelDungeonTemplateResources=[new ig.Image("/Html/media/sprites/sky-tiles.png"),new ig.Image("/Html/media/sprites/sky-tiles.png"),new ig.Image("/Html/media/sprites/sky-tiles.png")]}),ig.baked=!0,ig.module("game.plugins.caption").requires("impact.game","bootstrap.plugins.pause","impact.font","plugins.tween-lite").defines(function(){Caption=ig.Class.extend({captionText:"",captionFont:new ig.Font("media/fonts/nokia-36-white-shadow.png"),captionAreaObj:{x:0,y:0,height:60},animationTween:null,draw:function(){if(""!=this.captionText){this.animationTween&&ig.game.paused?this.animationTween.pause():this.animationTween&&!ig.game.paused,this.animationTween.paused()&&this.animationTween.play(),ig.system.context.fillStyle="rgba(0,0,0,0.8)",ig.system.context.fillRect(this.captionAreaObj.x,this.captionAreaObj.y,ig.system.width*ig.system.scale,this.captionAreaObj.height);var a=ig.system.width/2,b=this.captionAreaObj.y+10;this.captionFont.draw(this.captionText,a,b,ig.Font.ALIGN.CENTER)}},show:function(a,b){var c=this;a!=this.captionText&&(this.animationTween=TweenLite.fromTo(this.captionAreaObj,.8,{y:ig.system.height},{y:ig.system.height-this.captionAreaObj.height,ease:Strong.easeOut}),this.animationTween.pause(),this.animationTween.play().eventCallback("onStart",function(){c.captionText=a.toUpperCase()})),this.animationTween.eventCallback("onComplete",function(){c.animationTween.reverse().delay(b).eventCallback("onReverseComplete",function(){c.captionText=""})})},hide:function(){if(this.animationTween){var a=this;this.animationTween.reverse().delay(0).eventCallback("onReverseComplete",function(){a.captionText="",a.animationTween=null})}}}),ig.Game.inject({captionInstance:new Caption,displayCaption:function(a,b){this.captionInstance.show(a,b?b:2)},hideCaption:function(){this.captionInstance.hide()},clearCaption:function(){this.captionInstance.captionText=""},draw:function(){this.parent(),this.captionInstance.draw()}})}),ig.baked=!0,ig.module("game.entities.goat").requires("impact.entity","game.entities.hero-knight").defines(function(){EntityGoat=EntityHeroKnight.extend({size:{x:42,y:47},speed:5,health:1,attackDelay:8,speachChance:2,bonusSFX:new ig.Sound("media/sounds/KilledADude.*"),flipDelay:6,flipTimer:null,healthBonus:4,init:function(a,b,c){this.parent(a,b,c),this.flipTimer=new ig.Timer,this.flipDelay=Math.round(Math.random()*this.flipDelay)+3},setupAnimation:function(){this.addTextureAtlasAnim(this.atlas,"idle",1,["goat.png"],!1),this.currentAnim.flip.x=this.flip},update:function(){this.parent(),this.flipDelay>0&&this.flipTimer.delta()>this.flipDelay&&(this.flipDirection(),this.flipDelay=-1)},check:function(a){a instanceof EntityPlayer&&(a.flip!=this.flip?(a.health+=this.healthBonus,a.health>a.maxHealth&&(a.health=a.maxHealth),this.receiveDamage(this.health+1,null),this.bonusSFX.play()):(this.flipDelay=-1,this.flipDirection()))},onKilled:function(){this.parent(),ig.game.displayCaption("YOU JUST ATE A GOAT!",2)}})}),ig.baked=!0,ig.module("game.screens.game-screen").requires("impact.game","impact.font","bootstrap.plugins.camera","game.plugins.effects","game.levels.dungeon-template","game.plugins.caption","game.entities.goat").defines(function(){GameScreen=ig.Game.extend({lifeBar:new ig.Image("media/sprites/life-bar.png"),pauseButton:new ig.Image("media/sprites/pause.png"),player:null,screenBoundary:null,gravity:300,score:0,levelTimer:new ig.Timer,levelTime:0,quakeTimer:new ig.Timer,duration:1,strength:3,enterSFX:new ig.Sound("media/sounds/enter-level.*"),totalKills:0,kills:0,totalDeaths:0,level:0,maxLevels:5,mainMap:null,collisionMap:null,spawnerOffset:0,leftSpawner:null,rightSpawner:null,spawner:null,nextLevel:0,rewardsTotal:0,gameOver:!1,cameraYOffset:110,gameOverDelay:7,gameOverDelayTimer:new ig.Timer,gameOverSFX:new ig.Sound("media/sounds/death-theme.*"),showHUD:!1,quitButton:{name:"quit",label:"QUIT GAME",x:0,y:0,width:0,height:0},soundButton:{name:"sound",label:"SOUND",x:0,y:0,width:0,height:0},musicButton:{name:"music",label:"MUSIC",x:0,y:0,width:0,height:0},ad:null,font:new ig.Font("media/fonts/nokia-36-white-shadow.png"),init:function(){this.loadLevel(LevelDungeonTemplate),this.ad=document.getElementById("ad"),this.ad&&(this.showPurchaseText=!0),ig.input.debugHitAreas=!0,this.alignButtons()},alignButtons:function(){ig.input.clearHitAreas();var a=.5*ig.system.width,b=100;ig.input.registerHitArea("left",0,b,a,ig.system.height-b),ig.input.registerHitArea("right",a,b,a,ig.system.height-b),this.pauseX=.5*(ig.system.width-this.pauseButton.width),ig.input.registerHitArea("pause",this.pauseX,8,this.pauseButton.width,.5*this.pauseButton.height),this.quitButton.width=this.font.widthForString(this.quitButton.label),this.quitButton.height=this.font.heightForString(this.quitButton.label),this.quitButton.x=ig.system.width-(this.quitButton.width+5),this.quitButton.y=3,ig.input.registerHitArea(this.quitButton.name,this.quitButton.x,this.quitButton.y,this.quitButton.width,this.quitButton.height),this.soundButton.width=this.font.widthForString(this.soundButton.label+" OFF"),this.soundButton.height=this.font.heightForString(this.soundButton.label),this.soundButton.x=3,this.soundButton.y=3,ig.input.registerHitArea(this.soundButton.name,this.soundButton.x,this.soundButton.y,this.soundButton.width,this.soundButton.height)},onViewChanged:function(){this.alignButtons()},loadLevel:function(a){this.totalKills=0,this.kills=0,this.parent(a),this.player=this.getEntitiesByType(EntityPlayer)[0],this.cameraFollow=this.player,this.mainMap=ig.game.getMapByName("main"),this.collisionMap=ig.game.getMapByName("collision"),this.leftSpawner=ig.game.getEntityByName("leftSide"),this.rightSpawner=ig.game.getEntityByName("rightSide"),this.spawner=ig.game.getEntityByName("spawner"),this.spawner.activate(this.level),this.spawnerBonus=this.getEntityByName("spawner-bonus"),this.spawnerBonus.activate(),this.spawnerOffset=this.mainMap.height*this.mainMap.tilesize-this.leftSpawner.pos.y;var b=this.mainMap.tilesize;this.screenBoundary={min:{x:b,y:.5*-b},max:{x:this.mainMap.width*b-b-ig.system.width,y:this.mainMap.height*b-b-ig.system.height}},this.levelUp()},update:function(){this.parent(),this.gameOver?this.gameOverDelayTimer.delta()>this.gameOverDelay&&this.exitGame():ig.input.pressed("pause")?this.togglePause():this.paused?(ig.input.pressed("quit")&&ig.system.setGame(StartScreen),ig.input.pressed("sound")&&(ig.soundManager.volume=ig.soundManager.volume>0?0:1,ig.music.volume=ig.music.volume>0?0:1)):ig.input.pressed("left")?this.player.move("left"):ig.input.pressed("right")&&this.player.move("right"),this.kills>this.totalKills-1&&this.moveToNextLevel(),this.showHUD=this.screen.y>700?!0:!1},moveToNextLevel:function(){this.gameOver||(this.player.onRage(),this.levelUp(),this.spawner.totalSpawns+=0==this.level%5?1:0,this.spawnerBonus.baseSpawnLimit+=0==this.level%6?1:0,this.spawner.delay/=1.05,this.spawner.delay<.8&&(this.spawner.delay=.8),this.spawnerBonus.delay/=1.06,this.spawnerBonus.delay<1&&(this.spawnerBonus.delay=1),this.spawner.activate(this.level),this.spawnerBonus.activate())},levelUp:function(){this.level++;var a=this.level+1;this.totalKills=2*a*a,this.displayCaption("NEED "+(this.totalKills-this.kills)+" XP TO ADVANCE.",1==this.level?8:4),this.enterSFX.play()},onGameOver:function(){this.gameOver=!0,this.gameOverDelayTimer.reset(),this.displayCaption("YOU WERE KILLED!",3*this.level+this.gameOverDelay),ig.music.fadeOut(1),this.gameOverSFX.play()},exitGame:function(){this.hideCaption(),ig.system.setGame(StartScreen)},onPause:function(){this.parent(),this.levelTimer.pause(),ig.music.pause()},onResume:function(){this.parent(),this.levelTimer.unpause(),ig.music.play()},draw:function(){if(this.parent(),!this.gameOver){if(this.showHUD&&!this.paused){this.font.draw("LV: "+this.level.toString().pad(2,"0"),10,3),this.font.draw("XP: "+this.kills.toString().pad(2,"0")+(this.totalKills>0?"/"+this.totalKills.toString().pad(2,"0"):""),10,44);var a=this.player?10-Math.floor(10*(this.player.health/this.player.maxHealth)):10;this.lifeBar.drawTile(ig.system.width-this.lifeBar.width-10,10,a,this.lifeBar.width,32),"touch"==ig.input.touchType&&(ig.entitiesTextureAtlas.drawFrame("touch-arrow-right.png",ig.system.width-110,.5*(ig.system.height-316)+25),ig.entitiesTextureAtlas.drawFrame("touch-arrow-left.png",40,.5*(ig.system.height-316)+25))}this.pauseButton.drawTile(this.pauseX,8,this.paused?1:0,60,34)}this.paused&&(this.font.draw(this.quitButton.label,this.quitButton.x,this.quitButton.y),this.font.draw(this.soundButton.label+(ig.soundManager.volume>0?" ON":" OFF"),this.soundButton.x,this.soundButton.y)),this.scanLines&&this.scanLines.draw(0,0)}})}),ig.baked=!0,ig.module("game.screens.start-screen").requires("impact.game","game.screens.game-screen").defines(function(){StartScreen=ig.Game.extend({backgroundObj:{x:0,y:0},logoObj:{x:0,y:0},logoMaskObj:{x:0,y:0},backgroundMaskBObj:{x:0,y:0},startBlinkTimer:new ig.Timer,showStartText:!1,animationDone:!1,logoTween:null,splashScreenTextures:null,startSFX:new ig.Sound("media/sounds/start-game.*"),init:function(){this.splashScreenTextures=ig.screensTextureAtlas,ig.input.bind(ig.KEY.MOUSE2),ig.input.registerHitArea("click",0,0,ig.system.width,ig.system.height),this.setupTweens(),this.animateIntoIn(this.animationIntroInComplete),ig.music.play("track1"),ig.input.bind(ig.KEY.ENTER,"enter")},setupTweens:function(){var a=this.splashScreenTextures.getFrameData("title.png").frame;this.activeBGImg="background-image.png";var b=this.splashScreenTextures.getFrameData(this.activeBGImg).frame;this.backgroundObj.x=.5*(ig.system.width-(b.w-53)),this.backgroundObj.y=.5*(ig.system.height-b.h),this.ad&&ig.system.height<=786&&(this.backgroundObj.y=10),this.logoObj.x=ig.system.width+300,this.logoObj.y=ig.system.height-300,this.logoTween=TweenLite.fromTo(this.logoObj,.5,{x:this.logoObj.x,y:this.logoObj.y},{x:this.backgroundObj.x+b.w-a.w-50,y:this.backgroundObj.y+b.h-a.h-15,delay:0,ease:Strong.easeOut}),this.logoTween.pause(),this.backgroundMaskBObj.x=this.backgroundObj.x,this.backgroundMaskBObj.y=this.backgroundObj.y-70,this.backgroundMaskBObj.w=755,this.backgroundMaskBObj.h=600,this.backrgoundMaskTween=TweenLite.fromTo(this.backgroundMaskBObj,1,{y:this.backgroundMaskBObj.y},{y:ig.system.height,ease:Quart.easeInOut}),this.backrgoundMaskTween.pause()},animateIntoIn:function(){this.mode="animateIntroIn",this.logoTween.play(),this.animateMaskDown(.3,this.animationComplete)},animateIntroOut:function(){this.mode="animateIntroOut",this.animationDone=this.showStartText=!1,this.backrgoundMaskTween.reverse().delay(.1),this.logoTween.reverse().delay(.4).eventCallback("onReverseComplete",this.animationComplete)},animateMaskUp:function(a,b){this.backrgoundMaskTween.reverse().delay(a).eventCallback("onReverseComplete",b)},animateMaskDown:function(a,b){this.backrgoundMaskTween.play().delay(a).eventCallback("onComplete",b)},animationComplete:function(){switch(ig.game.mode){case"animateIntroIn":ig.game.animationDone=!0;break;case"animateIntroOut":ig.game.gotoNextScreen()}},gotoNextScreen:function(){ig.system.setGameNow(GameScreen,"0.js")},update:function(){ig.input.pressed("click")&&this.animationDone&&(this.onStart(),this.startSFX.play()),this.parent(),this.animationDone&&(this.showStartText=Math.round(this.startBlinkTimer.delta())%2?!0:!1),ig.input.pressed("enter")&&this.onStart()},onStart:function(){this.animateIntroOut(this.animationInrtoOutComplete)},draw:function(){this.parent(),this.splashScreenTextures.drawFrame(this.activeBGImg,this.backgroundObj.x,this.backgroundObj.y),ig.system.context.fillStyle="rgba(0,0,0,1)",ig.system.context.fillRect(this.backgroundMaskBObj.x,this.backgroundMaskBObj.y,this.backgroundMaskBObj.w,this.backgroundMaskBObj.h),this.showStartText&&this.splashScreenTextures.drawFrame("start-text.png",this.backgroundObj.x,this.backgroundObj.y+25),this.splashScreenTextures.drawFrame("background-mask.png",this.backgroundObj.x,this.logoObj.y-30),this.splashScreenTextures.drawFrame("title.png",this.logoObj.x,this.logoObj.y),ig.system.context.fillRect(this.backgroundObj.x+this.backgroundObj.width,this.backgroundObj.y-100,this.backgroundMaskBObj.w,this.backgroundMaskBObj.h)}})}),ig.baked=!0,ig.module("game.main").requires("impact.game","bootstrap.plugins.resize","bootstrap.plugins.hit-area","bootstrap.plugins.texture-atlas","bootstrap.plugins.pause","bootstrap.platforms.win8","bootstrap.plugins.utils","game.entities.death-explosion","plugins.tween-lite","game.packed-textures","game.screens.start-screen").defines(function(){Menu.inject({menuFont:new ig.Font("media/fonts/nokia-36-white-shadow.png"),init:function(){this.title="PAUSED"}}),ig.SoundManager.inject({init:function(){for(var a=new Audio,b=0;b<ig.Sound.use.length;b++){var c=ig.Sound.use[b];if(a.canPlayType(c.mime)){this.format=c;break}}this.format||(ig.Sound.enabled=!1)}}),ig.Music.inject({add:function(a,b){var c=a instanceof ig.Sound?a.path:a,d=ig.soundManager.load(c,!1);d.loop=this._loop,d.volume=this._volume,d.addEventListener("ended",this._endedCallbackBound,!1),this.tracks.push(d),b&&(this.namedTracks[b]=d),this.currentTrack||(this.currentTrack=d)}}),ig.startNewGame=function(a,b){ig.ua.mobile&&(ig.Sound.enabled=!1),ig.main("#canvas",StartScreen,60,a,b,1),ig.music.add(new ig.Sound("media/sounds/MonsterStomperLOOP.*"),"track1"),ig.music.loop=!0,ig.resizeGame&&ig.resizeGame()},"undefined"==typeof WinJS&&ig.startNewGame(800,480)});